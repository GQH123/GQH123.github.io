
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Renatus&#39;s Blog">
    <title>BZOJ阶段性汇总V - Renatus&#39;s Blog</title>
    <meta name="author" content="Renatus">
    
    
        <link rel="icon" href="http://res.cloudinary.com/goseqh/image/upload/v1501464937/new2_qgnz5x.png">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="引言How can I stay with you … forever ? …">
<meta name="keywords" content="题解,BZOJ">
<meta property="og:type" content="blog">
<meta property="og:title" content="BZOJ阶段性汇总V">
<meta property="og:url" content="https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/index.html">
<meta property="og:site_name" content="Renatus&#39;s Blog">
<meta property="og:description" content="引言How can I stay with you … forever ? …">
<meta property="og:image" content="https://gqh123.github.io/JudgeOnline/upload/201407/11(4).jpg">
<meta property="og:image" content="https://gqh123.github.io/JudgeOnline/upload/201407/22(2).jpg">
<meta property="og:updated_time" content="2019-06-27T07:29:24.788Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="BZOJ阶段性汇总V">
<meta name="twitter:description" content="引言How can I stay with you … forever ? …">
<meta name="twitter:image" content="https://gqh123.github.io/JudgeOnline/upload/201407/11(4).jpg">
    
    
        
    
    
        <meta property="og:image" content="https://gqh123.github.io/assets/images/2016-02-23.png"/>
    
    
        <meta property="og:image" content="http://res.cloudinary.com/goseqh/image/upload/v1502772151/1456293224732_sxxslo.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://res.cloudinary.com/goseqh/image/upload/v1502772151/1456293224732_sxxslo.jpg" />
    
    
        <meta property="og:image" content="http://res.cloudinary.com/goseqh/image/upload/v1502772151/1456293224732_sxxslo.jpg"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://res.cloudinary.com/goseqh/image/upload/v1502772151/1456293224732_sxxslo.jpg" />
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-sxklfps8ywgfyyjcowvnb4gxdgt0zjts3hsguljmv9uqanxjbnitrovtbrek.min.css">
    <!--STYLES END-->
    
    
    <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?9505a5af654a2478f93fd6c0ae4f687d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

    <body>
        <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="blog">
            <!-- Define author's picture -->


<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">Renatus&#39;s Blog</a>
    </div>
    
        
            <a  class="header-right-icon open-algolia-search"
                href="#search">
        
        
            <i class="fa fa-lg fa-search"></i>
        
        </a>
    
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?5fc847eb9d9d78d9abdc859c2181ec2f";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/2016-02-23.png" alt="作者的图片"/>
                </a>
                <h4 class="sidebar-profile-name">Renatus</h4>
                
                    <h5 class="sidebar-profile-bio"><p>For what I cherish forever.</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-search"></i>
                        <span class="sidebar-button-desc">搜索</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                        <span class="sidebar-button-desc">关于</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/GQH123" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="mailto:572694553@qq.com" target="_blank" rel="noopener">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                        <span class="sidebar-button-desc">QQmail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
        <div class="post-header-cover
                    text-left
                    "
             style="background-image:url('http://res.cloudinary.com/goseqh/image/upload/v1502772151/1456293224732_sxxslo.jpg');"
             data-behavior="4">
            
                <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            BZOJ阶段性汇总V
        </h1>
    
    
        <div class="post-meta">
    <time itemprop="datePublished" datetime="2017-09-07T18:04:36+08:00">
	
		    9月 07, 2017
    	
    </time>
    
</div>

    
</div>
            
        </div>

            <div id="main" data-behavior="4"
                 class="hasCover
                        hasCoverMetaIn
                        hasCoverCaption">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
        <span class="post-header-cover-caption caption">Don&#39;t wait for the perfect moment. Take the moment and make it perfect.</span>
    
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <h1 id="table-of-contents">目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#引言"><span class="toc-text">引言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3400: [Usaco2009 Mar]Cow Frisbee Team 奶牛沙盘队</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">4817: [Sdoi2017]树点涂色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-1"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-1"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3732: Network</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-2"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-2"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3702: 二叉树</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-3"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-3"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3669: [Noi2014]魔法森林</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-4"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-4"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3629: [JLOI2014]聪明的燕姿</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-5"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-5"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">4552: [Tjoi2016&Heoi2016]排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-6"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-6"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">4281: [ONTAK2015]Związek Harcerstwa Bajtockiego</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-7"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-7"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3670: [Noi2014]动物园</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-8"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-8"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-text">3530: [Sdoi2014]数数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">HINT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-text">Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题目分析-9"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-9"><span class="toc-text">代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol></li></ol>
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>How can I stay with you … forever ? …<br><a id="more"></a></p>
<p><title>Problem 3400. -- [Usaco2009 Mar]Cow Frisbee Team 奶牛沙盘队</title><center><h2>3400: [Usaco2009 Mar]Cow Frisbee Team 奶牛沙盘队</h2><span class="green">Time Limit: </span>3 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>128 MB<br><span class="green">Submit: </span>290&nbsp;&nbsp;<span class="green">Solved: </span>195<br>[<a href="submitpage.php?id=3400">Submit</a>][<a href="problemstatus.php?id=3400">Status</a>][<a href="bbs.php?id=3400">Discuss</a>]</center></p><h3>Description</h3><div class="content"><div><span style="font-size: medium">&nbsp;&nbsp;&nbsp;&nbsp;农夫顿因开始玩飞盘之后，约翰也打算让奶牛们享受飞盘的乐趣．他要组建一只奶牛飞盘</span></div><p></p>
<div><span style="font-size: medium">队．他的N(1&le;N&le;2000)只奶牛，每只部有一个飞盘水准指数Ri(1&le;Ri&le;100000)．约翰要选出1只或多于1只奶牛来参加他的飞盘队．由于约翰的幸运数字是F(1&le;F&le;1000)，他希望所有奶牛的飞盘水准指数之和是幸运数字的倍数．</span></div>
<div><span style="font-size: medium">&nbsp;&nbsp;&nbsp;&nbsp;帮约翰算算一共有多少种组队方式．</span></div></div><h3>Input</h3><div class="content"><div><span style="font-size: medium">&nbsp;&nbsp;&nbsp;&nbsp;第1行输入N和F，之后N行输入Ri．</span></div></div><h3>Output</h3><div class="content"><div>&nbsp;</div>
<div><span style="font-size: medium">&nbsp;&nbsp;&nbsp;&nbsp;组队方式数模10^8取余的结果．</span></div></div><h3>Sample Input</h3>
<div class="content"><span class="sampledata">4 5<br>
1<br>
2<br>
8<br>
2</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">3</span></div><h3>HINT</h3>
<div class="content"><p></p><p class="MsoNormal" style="margin: 0cm 0cm 0pt"><font size="3"><span lang="EN-US"><font face="Times New Roman">&nbsp;&nbsp;&nbsp;&nbsp;</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">组队方式有</span><span lang="EN-US"><font face="Times New Roman">(2</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US"><font face="Times New Roman">3)</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US"><font face="Times New Roman">(3</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US"><font face="Times New Roman">4)</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US"><font face="Times New Roman">(1</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US"><font face="Times New Roman">2</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US"><font face="Times New Roman">4)</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'Times New Roman'; mso-hansi-font-family: 'Times New Roman'">共三种</span></font></p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search=Silver">Silver</a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>动态规划</li>
<li>数位DP</li>
</ul>
<hr>
<h2 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>模数数位DP问题</strong></p>
<p>记录两维：当前考虑的奶牛和当前的余数，直接转移即可</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 2005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 100000000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> dp[maxn][maxn];</div><div class="line"><span class="keyword">bool</span> vis[maxn][maxn];</div><div class="line"><span class="keyword">int</span> ski[maxn];</div><div class="line"><span class="keyword">int</span> n, f;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DP</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> rest)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (pos == n) <span class="keyword">return</span> (!rest) ? <span class="number">1</span> : <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (vis[pos][rest]) <span class="keyword">return</span> dp[pos][rest];</div><div class="line">    vis[pos][rest] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span>&amp; ans = dp[pos][rest];</div><div class="line">    <span class="keyword">return</span> ans = (DP(pos + <span class="number">1</span>, (rest + ski[pos]) % f) + DP(pos + <span class="number">1</span>, rest)) % M;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;f);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ski[i]), ski[i] %= f;</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</div><div class="line">        ans = (ans + DP(i + <span class="number">1</span>, ski[i])) % M;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 4817. -- [Sdoi2017]树点涂色</title><center><h2>4817: [Sdoi2017]树点涂色</h2><span class="green">Time Limit: </span>10 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>128 MB<br><span class="green">Submit: </span>481&nbsp;&nbsp;<span class="green">Solved: </span>279<br>[<a href="submitpage.php?id=4817">Submit</a>][<a href="problemstatus.php?id=4817">Status</a>][<a href="bbs.php?id=4817">Discuss</a>]</center></p><h3>Description</h3><div class="content"><div>Bob有一棵n个点的有根树，其中1号点是根节点。Bob在每个点上涂了颜色，并且每个点上的颜色不同。定义一条路</div><p></p>
<div>径的权值是：这条路径上的点（包括起点和终点）共有多少种不同的颜色。Bob可能会进行这几种操作：</div>
<div>1 x:</div>
<div>把点x到根节点的路径上所有的点染上一种没有用过的新颜色。</div>
<div>2 x y:</div>
<div>求x到y的路径的权值。</div>
<div>3 x y:</div>
<div>在以x为根的子树中选择一个点，使得这个点到根节点的路径权值最大，求最大权值。</div>
<div>Bob一共会进行m次操作</div>
<div></div></div><h3>Input</h3><div class="content"><div>第一行两个数n,m。</div>
<div>接下来n-1行，每行两个数a,b，表示a与b之间有一条边。</div>
<div>接下来m行，表示操作，格式见题目描述</div>
<div>1&lt;=n,m&lt;=100000</div>
<div></div></div><h3>Output</h3><div class="content"><div>每当出现2,3操作，输出一行。</div>
<div>如果是2操作，输出一个数表示路径的权值</div>
<div>如果是3操作，输出一个数表示权值的最大值</div>
<div></div></div><h3>Sample Input</h3>
<div class="content"><span class="sampledata">5 6<br>
1 2<br>
2 3<br>
3 4<br>
3 5<br>
2 4 5<br>
3 3<br>
1 4<br>
2 4 5<br>
1 5<br>
2 4 5</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">3<br>
4<br>
2<br>
2</span></div><h3>HINT</h3>
<div class="content"><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search=鸣谢infinityedge上传">鸣谢infinityedge上传</a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>数据结构</li>
<li>LCT</li>
<li>LCT思想</li>
</ul>
<hr>
<h2 id="题目分析-1"><a href="#题目分析-1" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>树上动态维护问题</strong></p>
<p>本题是一个LCT类比的思路，就是用access操作类比题目中的染色操作，为什么这样类比呢？因为这样做，我们可以清楚地知道那些链是同色的，在改变颜色以及统计答案时都会比较方便，如果只是使用树链剖分，我们就不会知道一条链的哪些地方颜色发生了中断，就无法维护信息了</p>
<p>几乎是人生第一次正式的使用LCT，练习了一下，于是就发生了一个大错误，调了我一半夜，凌晨3点才调完。。。那就是每个splay的顶端并非链的顶端，我们要更新的话，要用链的顶端，这样就要在splay上一直向左跑才行。。。然而我很晚才发现这件事情。。。</p>
<p><del>直接扒自己的LOJ题解。。。</del></p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> next, to;</div><div class="line">    edge(<span class="keyword">int</span> next, <span class="keyword">int</span> to) : next(next), to(to)&#123;&#125;</div><div class="line">    edge()&#123;&#125;</div><div class="line">&#125;e[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>, h[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add_Edge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">    e[++cnt] = edge(h[x], y);</div><div class="line">    h[x] = cnt;</div><div class="line">    e[++cnt] = edge(h[y], x);</div><div class="line">    h[y] = cnt;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> fa[maxn];</div><div class="line"><span class="keyword">int</span> son[maxn];</div><div class="line"><span class="keyword">int</span> d[maxn];</div><div class="line"><span class="keyword">int</span> si[maxn];</div><div class="line"><span class="keyword">int</span> top[maxn];</div><div class="line"><span class="keyword">int</span> dfs[maxn];</div><div class="line"><span class="keyword">int</span> idfs[maxn];</div><div class="line"><span class="keyword">int</span> t;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS1</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i; i = e[i].next)&#123;</div><div class="line">        <span class="keyword">int</span> op = e[i].to;</div><div class="line">        <span class="keyword">if</span> (op == fa[x]) <span class="keyword">continue</span>;</div><div class="line">        fa[op] = x;</div><div class="line">        d[op] = d[x] + <span class="number">1</span>;</div><div class="line">        DFS1(op);</div><div class="line">        si[x] += si[op];</div><div class="line">        <span class="keyword">if</span> (si[op] &gt; si[son[x]]) son[x] = op;</div><div class="line">    &#125;</div><div class="line">    si[x]++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> tp)</span></span>&#123;</div><div class="line">    top[x] = tp;</div><div class="line">    dfs[x] = ++t;</div><div class="line">    idfs[t] = x;</div><div class="line">    <span class="keyword">if</span> (son[x]) DFS2(son[x], tp);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i; i = e[i].next)&#123;</div><div class="line">        <span class="keyword">int</span> op = e[i].to;</div><div class="line">        <span class="keyword">if</span> (op == son[x] || op == fa[x]) <span class="keyword">continue</span>;</div><div class="line">        DFS2(op, op);</div><div class="line">    &#125;</div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="keyword">int</span> maxnum[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> add[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> qx, qy, qd;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (add[o] != <span class="number">0</span> &amp;&amp; l != r)&#123;</div><div class="line"></div><div class="line">        add[o &lt;&lt; <span class="number">1</span>] += add[o];</div><div class="line">        maxnum[o &lt;&lt; <span class="number">1</span>] += add[o];</div><div class="line"></div><div class="line">        add[o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += add[o];</div><div class="line">        maxnum[o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += add[o];</div><div class="line"></div><div class="line">        add[o] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</div><div class="line">    maxnum[o] = max(maxnum[o &lt;&lt; <span class="number">1</span>], maxnum[o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (l == r) &#123;</div><div class="line">        maxnum[o] = d[idfs[l]] + <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    init(l, mid, o &lt;&lt; <span class="number">1</span>);</div><div class="line">    init(mid + <span class="number">1</span>, r,  o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</div><div class="line">    pushup(l, r, o);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    pushdown(l, r, o);</div><div class="line">    <span class="keyword">if</span> (qx &lt;= l &amp;&amp; r &lt;= qy)&#123;</div><div class="line">        maxnum[o] += qd;</div><div class="line">        add[o] += qd;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (qx &lt;= mid) modify(l, mid, o &lt;&lt; <span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> (qy &gt; mid) modify(mid + <span class="number">1</span>, r, o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</div><div class="line">    pushup(l, r, o);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    pushdown(l, r, o);</div><div class="line">    <span class="keyword">if</span> (qx &lt;= l &amp;&amp; r &lt;= qy) <span class="keyword">return</span> maxnum[o];</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (qx &lt;= mid) ans = max(ans, get(l, mid, o &lt;&lt; <span class="number">1</span>));</div><div class="line">    <span class="keyword">if</span> (qy &gt; mid) ans = max(ans, get(mid + <span class="number">1</span>, r, o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>));</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> f[maxn];</div><div class="line"><span class="keyword">int</span> ch[maxn][<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) f[i] = fa[i];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> (!f[x] || (ch[f[x]][<span class="number">0</span>] != x &amp;&amp; ch[f[x]][<span class="number">1</span>] != x));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(is_root(t))<span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> k=f[t];</div><div class="line">    <span class="keyword">if</span>(!is_root(k))&#123;</div><div class="line">        ch[f[k]][ch[f[k]][<span class="number">0</span>]==k?<span class="number">0</span>:<span class="number">1</span>]=t;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> d=(ch[k][<span class="number">0</span>]==t)?<span class="number">0</span>:<span class="number">1</span>;</div><div class="line">    f[t]=f[k];</div><div class="line">    ch[k][d]=ch[t][d^<span class="number">1</span>];</div><div class="line">    f[ch[k][d]]=k;</div><div class="line">    ch[t][d^<span class="number">1</span>]=k;</div><div class="line">    f[k]=t;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">    <span class="keyword">while</span>(!is_root(t))&#123;</div><div class="line">        <span class="keyword">int</span> fa=f[t];</div><div class="line">        <span class="keyword">if</span>(!is_root(fa))&#123;</div><div class="line">            <span class="keyword">int</span> ffa=f[fa];</div><div class="line">            <span class="keyword">int</span> f1=(ch[ffa][<span class="number">0</span>]==fa)?<span class="number">0</span>:<span class="number">1</span>;</div><div class="line">            <span class="keyword">int</span> f2=(ch[fa][<span class="number">0</span>]==t)?<span class="number">0</span>:<span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(f1^f2) rotate(t);</div><div class="line">            <span class="keyword">else</span> rotate(fa);</div><div class="line">        &#125;</div><div class="line">        rotate(t);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</div><div class="line">        splay(x);</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (ch[x][<span class="number">1</span>])&#123;  </div><div class="line">            <span class="keyword">int</span> _x = ch[x][<span class="number">1</span>];</div><div class="line">            <span class="keyword">while</span> (ch[_x][<span class="number">0</span>])&#123;</div><div class="line">                _x = ch[_x][<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            qx = dfs[_x], qy = dfs[_x] + si[_x] - <span class="number">1</span>, qd = <span class="number">1</span>;</div><div class="line">            modify(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        ch[x][<span class="number">1</span>] = tmp;</div><div class="line">        tmp = x;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (!f[x]) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">int</span> _x = x;</div><div class="line">        <span class="keyword">while</span> (ch[_x][<span class="number">0</span>])&#123;</div><div class="line">            _x = ch[_x][<span class="number">0</span>];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        qx = dfs[_x], qy = dfs[_x] + si[_x] - <span class="number">1</span>, qd = <span class="number">-1</span>;</div><div class="line">        modify(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">        x = f[x];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    access(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">    qx = qy = dfs[x];</div><div class="line">    <span class="keyword">int</span> a = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">    qx = qy = dfs[y];</div><div class="line">    <span class="keyword">int</span> b = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> f1 = top[x], f2 = top[y];</div><div class="line">    <span class="keyword">while</span> (f1 != f2)&#123;</div><div class="line">        <span class="keyword">if</span> (d[f1] &gt; d[f2])&#123;</div><div class="line">            x = fa[f1];</div><div class="line">            f1 = top[x];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            y = fa[f2];</div><div class="line">            f2 = top[y];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> lca = (d[x] &gt; d[y]) ? y : x;</div><div class="line">    <span class="keyword">int</span> c = fa[lca];</div><div class="line">    </div><div class="line">    qx = qy = dfs[lca];</div><div class="line">    lca = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line"></div><div class="line"></div><div class="line">    qx = qy = dfs[c];</div><div class="line">    <span class="keyword">if</span> (c) c = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">    <span class="keyword">else</span> c = <span class="number">0</span>; </div><div class="line"></div><div class="line">    <span class="keyword">if</span> (lca == c) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a + b - (c &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>);</div><div class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a + b - (c &lt;&lt; <span class="number">1</span>) - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    qx = dfs[x], qy = dfs[x] + si[x] - <span class="number">1</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, get(<span class="number">1</span>, n, <span class="number">1</span>));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_all</span><span class="params">()</span></span>&#123;</div><div class="line">    DFS1(<span class="number">1</span>);</div><div class="line">    DFS2(<span class="number">1</span>, <span class="number">1</span>);</div><div class="line">    init(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">    init();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">    <span class="keyword">int</span> x, y, op;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">        Add_Edge(x, y);</div><div class="line">    &#125;</div><div class="line">    init_all();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;op);</div><div class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">            modify(x);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">            query(x, y, i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">3</span>)&#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">            query(x);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 3732. -- Network</title><center><h2>3732: Network</h2><span class="green">Time Limit: </span>10 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>128 MB<br><span class="green">Submit: </span>1900&nbsp;&nbsp;<span class="green">Solved: </span>909<br>[<a href="submitpage.php?id=3732">Submit</a>][<a href="problemstatus.php?id=3732">Status</a>][<a href="bbs.php?id=3732">Discuss</a>]</center></p><h3>Description</h3><div class="content"><p>给你N个点的无向图 (1 &lt;= N &lt;= 15,000)，记为：1&hellip;N。 <br>
图中有M条边 (1 &lt;= M &lt;= 30,000) ，第j条边的长度为： d_j ( 1 &lt; = d_j &lt; = 1,000,000,000).</p><p></p>
<p></p><p>现在有 K个询问 (1 &lt; = K &lt; = 20,000)。 <br>
每个询问的格式是：A B，表示询问从A点走到B点的所有路径中，最长的边最小值是多少？</p>&lt;/div&gt;<h3>Input</h3><div class="content"><p>第一行： N, M, K。 <br>
第2..M+1行: 三个正整数：X, Y, and D (1 &lt;= X &lt;=N; 1 &lt;= Y &lt;= N). 表示X与Y之间有一条长度为D的边。 <br>
第M+2..M+K+1行: 每行两个整数A B,表示询问从A点走到B点的所有路径中，最长的边最小值是多少？</p></div><h3>Output</h3><div class="content"><p>&nbsp;对每个询问，输出最长的边最小值是多少。</p></div><h3>Sample Input</h3><p></p>
<div class="content"><span class="sampledata">6 6 8<br>
1 2 5<br>
2 3 4<br>
3 4 3<br>
1 4 8<br>
2 5 7<br>
4 6 2<br>
1 2<br>
1 3<br>
1 4<br>
2 3<br>
2 4<br>
5 1<br>
6 2<br>
6 1</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">5<br>
5<br>
5<br>
4<br>
4<br>
7<br>
4<br>
5</span></div><h3>HINT</h3>
<div class="content"><p></p><p>1 &lt;= N &lt;= 15,000 <br><br>
1 &lt;= M &lt;= 30,000 <br><br>
1 &lt;= d_j &lt;= 1,000,000,000 <br><br>
1 &lt;= K &lt;= 15,000 </p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search="></a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>图论</li>
<li>瓶颈路</li>
<li>最小生成树</li>
<li>LCA</li>
</ul>
<hr>
<h2 id="题目分析-2"><a href="#题目分析-2" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>图上两点瓶颈路问题</strong></p>
<p>我们先求一发最小生成树，然后直接在树上进行倍增LCA，本题即可解决</p>
<p>为什么这样是对的呢？我们可以思考Kruskal的思想，从最小的边逐个加入，那么一定满足瓶颈路这个要求</p>
<h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2000000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, k;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> x, y, len;</div><div class="line">    edge(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> len) : x(x), y(y), len(len)&#123;&#125;</div><div class="line">    edge()&#123;&#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> edge b) <span class="keyword">const</span>&#123;</div><div class="line">        <span class="keyword">return</span> len &lt; b.len;</div><div class="line">    &#125;</div><div class="line">&#125;e[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add_Edge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> len)</span></span>&#123;</div><div class="line">    e[++cnt] = edge(x, y, len);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge2</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> next, to, len;</div><div class="line">    edge2(<span class="keyword">int</span> next, <span class="keyword">int</span> to, <span class="keyword">int</span> len) : next(next), to(to), len(len)&#123;&#125;</div><div class="line">    edge2()&#123;&#125;</div><div class="line">&#125;e2[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> cnt2 = <span class="number">1</span>, h[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add_Edge2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> len)</span></span>&#123;</div><div class="line">    e2[++cnt2] = edge2(h[x], y, len);</div><div class="line">    h[x] = cnt2;</div><div class="line">    e2[++cnt2] = edge2(h[y], x, len);</div><div class="line">    h[y] = cnt2;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> ufs[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_root</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">return</span> ufs[x] = (ufs[x] == x) ? x : find_root(ufs[x]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> d[maxn];</div><div class="line"><span class="keyword">int</span> fa[maxn][<span class="number">30</span>];</div><div class="line"><span class="keyword">int</span> val[maxn][<span class="number">30</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">30</span>; i++) fa[x][i] = fa[fa[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">30</span>; i++) val[x][i] = max(val[x][i - <span class="number">1</span>], val[fa[x][i - <span class="number">1</span>]][i - <span class="number">1</span>]);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i; i = e2[i].next)&#123;</div><div class="line">        <span class="keyword">int</span> op = e2[i].to;</div><div class="line">        <span class="keyword">if</span> (op == fa[x][<span class="number">0</span>]) <span class="keyword">continue</span>;</div><div class="line">        fa[op][<span class="number">0</span>] = x;</div><div class="line">        d[op] = d[x] + <span class="number">1</span>;</div><div class="line">        val[op][<span class="number">0</span>] = e2[i].len;</div><div class="line">        DFS(op);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">    val[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    fa[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    DFS(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (d[x] &lt; d[y]) swap(x, y);</div><div class="line">    <span class="keyword">int</span> k = d[x] - d[y];</div><div class="line">    <span class="keyword">int</span> now = <span class="number">0</span>; </div><div class="line">    <span class="keyword">int</span> ans = -INF;</div><div class="line">    <span class="keyword">while</span> (k)&#123;</div><div class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = max(ans, val[x][now]), x = fa[x][now];</div><div class="line">        now++;</div><div class="line">        k &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> ans;</div><div class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">int</span> now = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (fa[x][now] != fa[y][now]) now++;</div><div class="line">        <span class="keyword">if</span> (now == <span class="number">0</span>) <span class="keyword">return</span> ans = max(ans, max(val[x][<span class="number">0</span>], val[y][<span class="number">0</span>]));</div><div class="line">        now--;</div><div class="line">        ans = max(ans, max(val[x][now], val[y][now]));</div><div class="line">        x = fa[x][now];</div><div class="line">        y = fa[y][now];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ufs[i] = i;</div><div class="line">    sort(e + <span class="number">1</span>, e + <span class="number">1</span> + cnt);</div><div class="line">    <span class="keyword">int</span> ct = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (ct == n - <span class="number">1</span>) <span class="keyword">break</span>;</div><div class="line">        edge op = e[i];</div><div class="line">        <span class="keyword">int</span> x = find_root(op.x);</div><div class="line">        <span class="keyword">int</span> y = find_root(op.y);</div><div class="line">        <span class="keyword">if</span> (x == y) <span class="keyword">continue</span>;</div><div class="line">        ufs[x] = y;</div><div class="line">        ct++;</div><div class="line">        Add_Edge2(op.x, op.y, op.len);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> x, y;</div><div class="line">    init();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, query(x, y));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> x, y, len;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;k);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;len);</div><div class="line">        Add_Edge(x, y, len);</div><div class="line">    &#125;</div><div class="line">    work();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 3702. -- 二叉树</title><center><h2>3702: 二叉树</h2><span class="green">Time Limit: </span>15 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>256 MB<br><span class="green">Submit: </span>561&nbsp;&nbsp;<span class="green">Solved: </span>251<br>[<a href="submitpage.php?id=3702">Submit</a>][<a href="problemstatus.php?id=3702">Status</a>][<a href="bbs.php?id=3702">Discuss</a>]</center></p><h3>Description</h3><div class="content"><p><span style="font-size: medium">现在有一棵二叉树，所有非叶子节点都有两个孩子。在每个叶子节点上有一个权值(有n个叶子节点，满足这些权值为1..n的一个排列)。可以任意交换每个非叶子节点的左右孩子。<br>
要求进行一系列交换，使得最终所有叶子节点的权值按照中序遍历写出来，逆序对个数最少。<br>
</span></p></div><h3>Input</h3><div class="content"><p><font size="4">第一行n<br>
下面每行，一个数x<br>
如果x==0，表示这个节点非叶子节点，递归地向下读入其左孩子和右孩子的信息，<br>
如果x!=0，表示这个节点是叶子节点，权值为x。<br>
</font></p></div><h3>Output</h3><div class="content"><p><font size="4">一行，最少逆序对个数。<br>
</font></p></div><h3>Sample Input</h3><p></p>
<div class="content"><span class="sampledata">3<br>
0<br>
0<br>
3<br>
1<br>
2<br>
</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">1</span></div><h3>HINT</h3>
<div class="content"><p></p><p><span style="font-size: medium">对于100%的数据：2&lt;=n&lt;=200000。</span></p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search="></a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>数据结构</li>
<li>线段树</li>
<li>线段树合并</li>
</ul>
<hr>
<h2 id="题目分析-3"><a href="#题目分析-3" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>线段树合并问题</strong></p>
<p>我们很容易发现，逆序对最少，我们只需要对两侧分别调整，而合并的时候看看两个整体哪个放前面会使逆序对最少即可， 这就是一种<strong>整体局部无关性</strong>的思想</p>
<p>那么，我们只需要使用线段树合并，即可容易地做到这一点</p>
<h2 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h2><p>第一次写线段树合并。。。好激动(≧▽≦)/</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long int</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span> ch[maxn][<span class="number">2</span>];</div><div class="line"><span class="keyword">int</span> cnt = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></div><div class="line">    node *l, *r;</div><div class="line">    <span class="keyword">int</span> val;</div><div class="line">    node(<span class="keyword">int</span> val) : val(val)&#123;&#125;</div><div class="line">    node()&#123;&#125;</div><div class="line">&#125;;</div><div class="line">node* save[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(node*&amp; x, node* y)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (y == <span class="literal">NULL</span>) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span> (x != <span class="literal">NULL</span>) x -&gt; val += y -&gt; val;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        x = y;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    merge(x -&gt; l, y -&gt; l);</div><div class="line">    merge(x -&gt; r, y -&gt; r);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, node*&amp; ans, <span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (ans == <span class="literal">NULL</span>) ans = <span class="keyword">new</span> node(v);</div><div class="line">    <span class="keyword">else</span> ans -&gt; val += v;</div><div class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (x &lt;= mid) insert(l, mid, x, ans -&gt; l, v);</div><div class="line">    <span class="keyword">else</span> insert(mid + <span class="number">1</span>, r, x, ans -&gt; r, v);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">find_rank</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, node* now)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (now == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (x &lt;= mid) <span class="keyword">return</span> find_rank(l, mid, x, now -&gt; l);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> ((now -&gt; l == <span class="literal">NULL</span>) ? <span class="number">0</span> : now -&gt; l -&gt; val) + find_rank(mid + <span class="number">1</span>, r, x, now -&gt; r);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> x;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">    <span class="keyword">if</span> (x == <span class="number">0</span>)&#123;</div><div class="line">        ch[o][<span class="number">0</span>] = ++cnt;</div><div class="line">        build(cnt);</div><div class="line">        ch[o][<span class="number">1</span>] = ++cnt;</div><div class="line">        build(cnt);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> insert(<span class="number">1</span>, n, x, save[o], <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_sum</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, node* x, node* y, LL&amp; sum)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (l == r)&#123;</div><div class="line">        sum += find_rank(<span class="number">1</span>, n, l, x);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (y -&gt; l != <span class="literal">NULL</span>) get_sum(l, mid, x, y -&gt; l, sum);</div><div class="line">    <span class="keyword">if</span> (y -&gt; r != <span class="literal">NULL</span>) get_sum(mid + <span class="number">1</span>, r, x, y -&gt; r, sum);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_all</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, node*&amp; x, node* y)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (l == r)&#123;</div><div class="line">        insert(<span class="number">1</span>, n, l, x, y -&gt; val);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (y -&gt; l != <span class="literal">NULL</span>) insert_all(l, mid, x, y -&gt; l);</div><div class="line">    <span class="keyword">if</span> (y -&gt; r != <span class="literal">NULL</span>) insert_all(mid + <span class="number">1</span>, r, x, y -&gt; r);</div><div class="line">&#125;</div><div class="line"></div><div class="line">LL ans = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> l = ch[o][<span class="number">0</span>], r = ch[o][<span class="number">1</span>];</div><div class="line">    <span class="keyword">if</span> (l)&#123;</div><div class="line">        work(l);</div><div class="line">        work(r);</div><div class="line">        LL sl = save[l] -&gt; val, sr = save[r] -&gt; val;</div><div class="line">        LL sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (sl &lt; sr) get_sum(<span class="number">1</span>, n, save[r], save[l], sum);</div><div class="line">        <span class="keyword">else</span> get_sum(<span class="number">1</span>, n, save[l], save[r], sum);</div><div class="line">        ans += min(sum, sl * sr - sum);</div><div class="line">        <span class="keyword">if</span> (sl &lt; sr)&#123;</div><div class="line">            merge(save[r], save[l]);</div><div class="line">            save[o] = save[r];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            merge(save[l], save[r]);</div><div class="line">            save[o] = save[l];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    build(<span class="number">1</span>);</div><div class="line">    work(<span class="number">1</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 3669. -- [Noi2014]魔法森林</title><center><h2>3669: [Noi2014]魔法森林</h2><span class="green">Time Limit: </span>30 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>512 MB<br><span class="green">Submit: </span>2909&nbsp;&nbsp;<span class="green">Solved: </span>1822<br>[<a href="submitpage.php?id=3669">Submit</a>][<a href="problemstatus.php?id=3669">Status</a>][<a href="bbs.php?id=3669">Discuss</a>]</center></p><h3>Description</h3><div class="content"><p class="p18" style="margin-top: 3.1pt; margin-bottom: 3.1pt; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: '宋体'">为了</span><span style="font-family: 'Times New Roman'">得到书法大家的真传，</span><span style="font-family: '宋体'">小</span><span style="font-family: 'Times New Roman'">E<span style="font-family: 宋体">同学</span></span><span style="font-family: '宋体'">下定决心去</span><span style="font-family: 'Times New Roman'">拜访</span><span style="font-family: '宋体'">住在</span><span style="font-family: 'Times New Roman'">魔法森林中的</span><span style="font-family: '宋体'">隐士。</span><span style="font-family: 'Times New Roman'">魔法森林</span><span style="font-family: '宋体'">可以被</span><span style="font-family: 'Times New Roman'">看</span><span style="font-family: '宋体'">成</span><span style="font-family: 'Times New Roman'">一个</span><span style="font-family: '宋体'">包含</span><span style="font-family: 'Times New Roman'">个N节点M条边的无向图</span><span style="font-family: '宋体'">，</span><span style="font-family: 'Times New Roman'">节点标号为1..N</span><span style="font-family: '宋体'">，</span><span style="font-family: 'Times New Roman'">边标号为1..M</span><span style="font-family: '宋体'">。初始时</span><span style="font-family: 'Times New Roman'">小<span style="font-family: 'Times New Roman'">E</span><span style="font-family: 宋体">同学在</span></span><span style="font-family: '宋体'">号节</span><span style="font-family: 'Times New Roman'">点1</span><span style="font-family: '宋体'">，隐士则</span><span style="font-family: 'Times New Roman'">住在号节点N</span><span style="font-family: '宋体'">。小</span><span style="font-family: 'Times New Roman'">E<span style="font-family: 宋体">需要通过这一片魔法森林，才能够拜访到隐士。</span></span></span></p><p></p>
<p></p><p class="p18" style="margin-top: 3.1pt; margin-bottom: 3.1pt; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: '宋体'">魔法森林</span><span style="font-family: 'Times New Roman'">中居住了</span><span style="font-family: '宋体'">一些妖怪。每当有人</span><span style="font-family: 'Times New Roman'">经过一条边</span><span style="font-family: '宋体'">的</span><span style="font-family: 'Times New Roman'">时候，这</span><span style="font-family: '宋体'">条边</span><span style="font-family: 'Times New Roman'">上的妖怪就会</span><span style="font-family: '宋体'">对其发起</span><span style="font-family: 'Times New Roman'">攻击。</span><span style="font-family: '宋体'">幸运</span><span style="font-family: 'Times New Roman'">的是，</span><span style="font-family: '宋体'">在号</span><span style="font-family: 'Times New Roman'">节点住着两种守护精灵</span><span style="font-family: '宋体'">：</span><span style="font-family: 'Times New Roman'">A<span style="font-family: 宋体">型守护精灵与</span><span style="font-family: 'Times New Roman'">B</span><span style="font-family: 宋体">型守护精灵</span></span><span style="font-family: '宋体'">。</span><span style="font-family: 'Times New Roman'">小<span style="font-family: 'Times New Roman'">E</span><span style="font-family: 宋体">可以借助</span></span><span style="font-family: '宋体'">它们</span><span style="font-family: 'Times New Roman'">的力量</span><span style="font-family: '宋体'">，达到</span><span style="font-family: 'Times New Roman'">自己的目的</span><span style="font-family: '宋体'">。</span></span></p><p></p>
<p></p><p class="p18" style="margin-top: 3.1pt; margin-bottom: 3.1pt; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: '宋体'">只要</span><span style="font-family: 'Times New Roman'">小<span style="font-family: 'Times New Roman'">E</span><span style="font-family: 宋体">带上足够多的守护精灵，</span></span><span style="font-family: '宋体'">妖怪</span><span style="font-family: 'Times New Roman'">们就不会发起攻击</span><span style="font-family: '宋体'">了。具体来说</span><span style="font-family: 'Times New Roman'">，</span><span style="font-family: '宋体'">无向图中的</span><span style="font-family: 'Times New Roman'">每一条边</span><span style="font-family: '宋体'">Ei包含</span><span style="font-family: 'Times New Roman'">两个</span><span style="font-family: '宋体'">权值Ai</span><span style="font-family: 'Times New Roman'">与Bi</span><span style="font-family: '宋体'">。</span><span style="font-family: 'Times New Roman'">若</span><span style="font-family: '宋体'">身上</span><span style="font-family: 'Times New Roman'">携带的</span><span style="font-family: '宋体'">A</span><span style="font-family: 'Times New Roman'">型守护精灵</span><span style="font-family: '宋体'">个数</span><span class="15" style="font-weight: bold; font-family: '宋体'; text-decoration: underline">不少于Ai</span><span style="font-family: '宋体'">，</span><span style="font-family: 'Times New Roman'">且<span style="font-family: 'Times New Roman'">B</span><span style="font-family: 宋体">型守护精灵个数</span></span><span class="15" style="font-weight: bold; font-family: '宋体'; text-decoration: underline">不少于Bi</span><span style="font-family: '宋体'">，</span><span style="font-family: 'Times New Roman'">这条边上的妖怪</span><span style="font-family: '宋体'">就</span><span style="font-family: 'Times New Roman'">不会对</span><span style="font-family: '宋体'">通过</span><span style="font-family: 'Times New Roman'">这条边</span><span style="font-family: '宋体'">的</span><span style="font-family: 'Times New Roman'">人发起攻击</span><span style="font-family: '宋体'">。</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">当且仅当</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">通过</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">这</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">片</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">魔法森林</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">的过程中没有</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">任意一条边</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">的</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">妖怪</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">向</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">小<span style="font-family: 'Times New Roman'">E</span><span style="font-family: 宋体">发起攻击</span></span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">，</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">他才能成功</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">找到</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">隐士。</span></span></p><p></p>
<p></p><p class="p17" style="margin-top: 0pt; margin-bottom: 0pt"><span style="font-size: medium"><span style="font-family: '宋体'">由于</span><span style="font-family: 'Times New Roman'">携带守护精灵是一件非常</span><span style="font-family: '宋体'">麻烦</span><span style="font-family: 'Times New Roman'">的事，小<span style="font-family: 'Times New Roman'">E</span><span style="font-family: 宋体">想要知道，</span></span><span style="font-family: '宋体'">要能够</span><span style="font-family: 'Times New Roman'">成功拜访到隐士，最少</span><span style="font-family: '宋体'">需要</span><span style="font-family: 'Times New Roman'">携带守护精灵</span><span style="font-family: '宋体'">的总个数</span><span style="font-family: 'Times New Roman'">。</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">守护精灵</span><span style="font-weight: bold; font-family: 'Times New Roman'; text-decoration: underline">的</span><span style="font-weight: bold; font-family: '宋体'; text-decoration: underline">总个数</span><span style="font-family: '宋体'">为</span><span style="font-family: 'Times New Roman'">A<span style="font-family: 宋体">型守护精灵的个数与</span><span style="font-family: 'Times New Roman'">B</span><span style="font-family: 宋体">型守护精灵的个数之和。</span></span><span style="font-weight: normal; font-family: '黑体'; mso-spacerun: 'yes'"><br>
</span></span></p>&lt;/div&gt;<h3>Input</h3><div class="content"><p><span style="font-size: medium">第1行包含两个整数N,M，表示无向图共有N个节点，M条边。 接下来M行，第行包含4个正整数Xi,Yi,Ai,Bi，描述第i条无向边。其中Xi与Yi为该边两个端点的标号，Ai与Bi的含义如题所述。 注意数据中可能包含重边与自环。 </span></p><p></p>
<p></p><p></p></div><h3>Output</h3><div class="content"><p><span style="font-size: medium">输出一行一个整数：如果小E可以成功拜访到隐士，输出小E最少需要携带的守护精灵的总个数；如果无论如何小E都无法拜访到隐士，输出&ldquo;-1&rdquo;（不含引号）。</span></p><p></p>
<p></p><p></p><p></p>
<p></p><p></p>&lt;/div&gt;<h3>Sample Input</h3><p></p>
<div class="content"><span class="sampledata">【输入样例1】<br>
4 5<br>
1 2 19 1<br>
2 3 8 12<br>
2 4 12 15<br>
1 3 17 8<br>
3 4 1 17<br>
<br>
 <br>
<br>
 <br>
<br>
【输入样例2】<br>
<br>
 <br>
3 1<br>
1 2 1 1<br>
<br>
 <br>
<br>
</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">【输出样例1】<br>
 <br>
32<br>
【样例说明1】<br>
如果小E走路径1→2→4，需要携带19+15=34个守护精灵；<br>
如果小E走路径1→3→4，需要携带17+17=34个守护精灵；<br>
如果小E走路径1→2→3→4，需要携带19+17=36个守护精灵；<br>
如果小E走路径1→3→2→4，需要携带17+15=32个守护精灵。<br>
综上所述，小E最少需要携带32个守护精灵。<br>
<br>
<br>
<br>
【输出样例2】<br>
<br>
 <br>
-1<br>
【样例说明2】<br>
小E无法从1号节点到达3号节点，故输出-1。 <br>
</span></div><h3>HINT</h3>
<div class="content"><p></p><p><span style="font-size: medium">2&lt;=n&lt;=50,000</span></p><br>
<p><span style="font-size: medium">0&lt;=m&lt;=100,000</span></p><br>
<p><span style="font-size: medium"><br><br>
1&lt;=ai ,bi&lt;=50,000<br><br>
</span></p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search="></a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>图论</li>
<li>二维属性</li>
<li>瓶颈路</li>
<li>动点SPFA</li>
<li>LCT</li>
</ul>
<hr>
<h2 id="题目分析-4"><a href="#题目分析-4" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>动点SPFA/二维瓶颈路问题</strong></p>
<p>正解显然是LCT，然而还有另一种方法，就是动点SPFA，把边按其中一维排序后逐个加入，然后只对当前存在的边跑SPFA，这样就过了。。。</p>
<h2 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h2><p>注意动点SPFA的写法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2000000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"><span class="keyword">int</span> f[maxn];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">	<span class="keyword">int</span> x, y, a, b;</div><div class="line">	edge(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> a, <span class="keyword">int</span> b) : x(x), y(y), a(a), b(b)&#123;&#125;</div><div class="line">	edge()&#123;&#125;</div><div class="line">&#125;e[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; save[maxn];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge a, edge b)</span></span>&#123;</div><div class="line">	<span class="keyword">return</span> a.a &lt; b.a;</div><div class="line">&#125;</div><div class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; spfa;</div><div class="line"><span class="keyword">int</span> now;</div><div class="line"><span class="keyword">int</span> ans = INF;</div><div class="line"><span class="keyword">bool</span> in[maxn];</div><div class="line"><span class="keyword">bool</span> have[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">SPFA</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">while</span> (!spfa.empty())&#123;</div><div class="line">		<span class="keyword">int</span> op = spfa.front();spfa.pop();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; save[op].size(); i++)&#123;</div><div class="line"><span class="keyword">int</span> t = save[op][i];</div><div class="line"><span class="keyword">if</span> (!have[t]) <span class="keyword">continue</span>;</div><div class="line"><span class="keyword">int</span> k = (e[t].x == op) ? e[t].y : e[t].x;</div><div class="line"><span class="keyword">if</span> (e[t].a &gt; now) <span class="keyword">continue</span>;</div><div class="line"><span class="keyword">if</span> (f[k] &gt; max(f[op], e[t].b))&#123;</div><div class="line">	f[k] = max(f[op], e[t].b);</div><div class="line">	<span class="keyword">if</span> (!in[k])&#123;</div><div class="line">		spfa.push(k);</div><div class="line">		in[k] = <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (k == n) ans = min(ans, now + f[k]);</div><div class="line">&#125;</div><div class="line">		&#125;</div><div class="line">		in[op] = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</div><div class="line">		edge op = e[i];</div><div class="line">		have[i] = <span class="number">1</span>;</div><div class="line">		<span class="keyword">int</span> a = op.x, b = op.y;</div><div class="line">		<span class="keyword">if</span> (a == b) <span class="keyword">continue</span>;</div><div class="line">		spfa.push(b);spfa.push(a);</div><div class="line">		now = op.a;</div><div class="line">		SPFA();</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; bfs;</div><div class="line">    bfs.push(<span class="number">1</span>);</div><div class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (!bfs.empty())&#123;</div><div class="line">        <span class="keyword">int</span> op = bfs.front();</div><div class="line">        bfs.pop();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; save[op].size(); i++)&#123;</div><div class="line">            <span class="keyword">int</span> k = save[op][i];</div><div class="line"><span class="keyword">int</span> t = (e[k].x == op) ? e[k].y : e[k].x;</div><div class="line"><span class="keyword">if</span> (vis[t]) <span class="keyword">continue</span>;</div><div class="line">vis[t] = <span class="number">1</span>;</div><div class="line">bfs.push(t);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">	<span class="keyword">if</span> (!vis[n]) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) f[i] = INF;</div><div class="line">	f[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> x, y, z, w;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;x, &amp;y, &amp;z, &amp;w);</div><div class="line">		e[i] = edge(x, y, z, w);</div><div class="line">	&#125;</div><div class="line">	sort(e, e + m, cmp);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123;</div><div class="line">		save[e[i].x].push_back(i);</div><div class="line">		save[e[i].y].push_back(i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (!judge())&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"-1"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	work();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><title>Problem 3629. -- [JLOI2014]聪明的燕姿</title><center><h2>3629: [JLOI2014]聪明的燕姿</h2><span class="green">Time Limit: </span>10 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>128 MB<br><span class="green">Submit: </span>1562&nbsp;&nbsp;<span class="green">Solved: </span>580<br>[<a href="submitpage.php?id=3629">Submit</a>][<a href="problemstatus.php?id=3629">Status</a>][<a href="bbs.php?id=3629">Discuss</a>]</center></p><h3>Description</h3><div class="content"><div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">阴天傍晚车窗外</span></div><p></p>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">未来有一个人在等待</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">向左向右向前看</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">爱要拐几个弯才来</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">我遇见谁会有怎样的对白</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">我等的人他在多远的未来</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">我听见风来自地铁和人海</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">我排着队拿着爱的号码牌</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">城市中人们总是拿着号码牌，不停寻找，不断匹配，可是谁也不知道自己等的那个人是谁。可是燕姿不一样，燕姿知道自己等的人是谁，因为燕姿数学学得好！燕姿发现了一个神奇的算法：假设自己的号码牌上写着数字S，那么自己等的人手上的号码牌数字的所有正约数之和必定等于S。</span></div>
<div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">所以燕姿总是拿着号码牌在地铁和人海找数字（喂！这样真的靠谱吗）可是她忙着唱《绿光》，想拜托你写一个程序能够快速地找到所有自己等的人。</span></div></div><h3>Input</h3><div class="content"><div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">输入包含k组数据（k&lt;=100）</span><span style="font-size: medium">对于每组数据，输入包含一个号码牌S</span></div></div><h3>Output</h3><div class="content"><div style="margin: 0cm 0cm 10pt"><span style="font-size: medium">对于每组数据，输出有两行，第一行包含一个整数m，表示有m个等的人，第二行包含相应的m个数，表示所有等的人的号码牌。注意：你输出的号码牌必须按照升序排列。</span></div></div><h3>Sample Input</h3>
<div class="content"><span class="sampledata">42</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">3<br>
20 26 41</span></div><h3>HINT</h3>
<div class="content"><p></p><p><span style="font-size: medium">对于100%的数据，有S&lt;=2*10*9<br><br>
</span></p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search="></a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>数学</li>
<li>质因子分析</li>
<li>DFS</li>
</ul>
<hr>
<h2 id="题目分析-5"><a href="#题目分析-5" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>质因子分析DFS问题</strong><br><del>省选题真是谁都能黑啊。。。</del><br><del>世道好轮回，省选绕过谁</del></p>
<p>本题即是传说中的对于质因子进行DFS暴力搜索的题目，然而我太弱，WA了无数次。。。</p>
<p>主要就是注意如何剪枝以及避免错误吧</p>
<h2 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2000000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long int</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> p[maxn][<span class="number">32</span>];</div><div class="line"><span class="keyword">int</span> save[maxn][<span class="number">32</span>];</div><div class="line"><span class="keyword">int</span> si[maxn];</div><div class="line"><span class="keyword">int</span> cnt;</div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (!vis[i]) p[cnt++][<span class="number">1</span>] = i;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt; j++)&#123;</div><div class="line">            <span class="keyword">if</span> (i * p[j][<span class="number">1</span>] &gt;= maxn) <span class="keyword">break</span>;</div><div class="line">            vis[i * p[j][<span class="number">1</span>]] = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (i % p[j][<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</div><div class="line">        save[i][<span class="number">0</span>] = p[i][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        save[i][<span class="number">1</span>] = p[i][<span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt; <span class="number">32</span>; j++)&#123;</div><div class="line">            <span class="keyword">if</span> ((LL)p[i][j - <span class="number">1</span>] * save[i][<span class="number">1</span>] &gt;= INF) &#123;</div><div class="line">                si[i] = j;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            save[i][j] = p[i][j] = p[i][j - <span class="number">1</span>] * save[i][<span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; si[i]; j++)&#123;</div><div class="line">            <span class="keyword">if</span> ((LL)p[i][j - <span class="number">1</span>] + p[i][j] &gt;= INF)&#123;</div><div class="line">                si[i] = j;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            p[i][j] += p[i][j - <span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> con = (<span class="keyword">int</span>) <span class="built_in">sqrt</span>(x);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (save[i][<span class="number">1</span>] &gt; con) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        <span class="keyword">if</span> (x % save[i][<span class="number">1</span>] == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> rest, <span class="keyword">int</span> now)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (rest &lt; p[pos][<span class="number">1</span>])&#123;</div><div class="line">        <span class="keyword">if</span> (rest == <span class="number">1</span>) ans.pb(now);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ((LL)rest &lt; (LL)p[pos][<span class="number">1</span>] * p[pos][<span class="number">1</span>] &amp;&amp; rest &lt; ((p[pos][<span class="number">2</span>] &gt; <span class="number">0</span>) ? p[pos][<span class="number">2</span>] : INF))&#123;</div><div class="line">        <span class="keyword">if</span> (judge(rest - <span class="number">1</span>)) ans.pb(now * (rest - <span class="number">1</span>));</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/*if (pos == cnt &amp;&amp; rest - 1 &gt;= maxn)&#123;</span></div><div class="line">        if (judge(rest - 1)) ans.pb(now * (rest - 1));</div><div class="line">        return;</div><div class="line">    &#125;*/</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; si[pos]; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (p[pos][i] &gt; rest) <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">if</span> (rest % p[pos][i] == <span class="number">0</span>) DFS(pos + <span class="number">1</span>, rest / p[pos][i], now * save[pos][i]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> f = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (!f)&#123;</div><div class="line">        DFS(<span class="number">0</span>, x, <span class="number">1</span>);</div><div class="line">        sort(ans.begin(), ans.end());</div><div class="line">        <span class="keyword">if</span> (ans.size() == <span class="number">0</span>)&#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"0"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans.size());</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans[<span class="number">0</span>]);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; ans.size(); i++) <span class="built_in">printf</span>(<span class="string">" %d"</span>, ans[i]);</div><div class="line">            ans.clear();</div><div class="line">        &#125;</div><div class="line">        f = <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    DFS(<span class="number">0</span>, x, <span class="number">1</span>);</div><div class="line">    sort(ans.begin(), ans.end());</div><div class="line">    <span class="keyword">if</span> (ans.size() == <span class="number">0</span>)&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n0"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n%d\n"</span>, ans.size());</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans[<span class="number">0</span>]);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; ans.size(); i++) <span class="built_in">printf</span>(<span class="string">" %d"</span>, ans[i]);</div><div class="line">        ans.clear();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    init();</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) work(n);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 4552. -- [Tjoi2016&Heoi2016]排序</title><center><h2>4552: [Tjoi2016&Heoi2016]排序</h2><span class="green">Time Limit: </span>60 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>256 MB<br><span class="green">Submit: </span>1187&nbsp;&nbsp;<span class="green">Solved: </span>622<br>[<a href="submitpage.php?id=4552">Submit</a>][<a href="problemstatus.php?id=4552">Status</a>][<a href="bbs.php?id=4552">Discuss</a>]</center></p><h3>Description</h3><div class="content"><div>在2016年，佳媛姐姐喜欢上了数字序列。因而他经常研究关于序列的一些奇奇怪怪的问题，现在他在研究一个难题</div><p></p>
<div>，需要你来帮助他。这个难题是这样子的：给出一个1到n的全排列，现在对这个全排列序列进行m次局部排序，排</div>
<div>序分为两种：1:(0,l,r)表示将区间[l,r]的数字升序排序2:(1,l,r)表示将区间[l,r]的数字降序排序最后询问第q</div>
<div>位置上的数字。</div></div><h3>Input</h3><div class="content"><div>输入数据的第一行为两个整数n和m。n表示序列的长度，m表示局部排序的次数。1 &lt;= n, m &lt;= 10^5第二行为n个整</div>
<div>数，表示1到n的一个全排列。接下来输入m行，每一行有三个整数op, l, r, op为0代表升序排序，op为1代表降序</div>
<div>排序, l, r 表示排序的区间。最后输入一个整数q，q表示排序完之后询问的位置, 1 &lt;= q &lt;= n。1 &lt;= n &lt;= 10^5</div>
<div>，1 &lt;= m &lt;= 10^5</div>
<div></div></div><h3>Output</h3><div class="content"><p>&nbsp;输出数据仅有一行，一个整数，表示按照顺序将全部的部分排序结束后第q位置上的数字。</p></div><h3>Sample Input</h3>
<div class="content"><span class="sampledata">6 3<br>
1 6 2 5 3 4<br>
0 1 4<br>
1 3 6<br>
0 2 4<br>
3</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">5</span></div><h3>HINT</h3>
<div class="content"><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search="></a></p></div>


<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>二分答案</li>
<li>线段树</li>
<li>线段树特殊操作</li>
</ul>
<hr>
<h2 id="题目分析-6"><a href="#题目分析-6" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>线段树特殊操作问题</strong><br>这题谁能想到是二分答案。。。虽然想到后好像挺合理的样子。。。</p>
<p>我们二分答案，然后即可把所有比它大的数看做1，其余的数看做0，然后升降序排序就变成了区间修改问题，最后根据所求位置上的数是0还是1判断左右二分</p>
<h2 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mod</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> op, l, r;</div><div class="line">    mod(<span class="keyword">int</span> op, <span class="keyword">int</span> l, <span class="keyword">int</span> r) : op(op), l(l), r(r)&#123;&#125;</div><div class="line">    mod()&#123;&#125;</div><div class="line">&#125;save[maxn];</div><div class="line"><span class="keyword">int</span> n, m, q;</div><div class="line"><span class="keyword">int</span> line[maxn];</div><div class="line"></div><div class="line"><span class="keyword">int</span> sum[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> <span class="built_in">set</span>[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> qx, qy, qd;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">set</span>[o] != <span class="number">-1</span> &amp;&amp; l != r)&#123;</div><div class="line">        <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line"></div><div class="line">        <span class="built_in">set</span>[o &lt;&lt; <span class="number">1</span>] = <span class="built_in">set</span>[o];</div><div class="line">        sum[o &lt;&lt; <span class="number">1</span>] = <span class="built_in">set</span>[o] * (mid + <span class="number">1</span> - l);</div><div class="line"></div><div class="line">        <span class="built_in">set</span>[o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="built_in">set</span>[o];</div><div class="line">        sum[o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] = <span class="built_in">set</span>[o] * (r - mid);</div><div class="line"></div><div class="line">        <span class="built_in">set</span>[o] = <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</div><div class="line">    sum[o] = sum[o &lt;&lt; <span class="number">1</span>] + sum[o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    <span class="built_in">set</span>[o] = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">if</span> (l == r)&#123;</div><div class="line">        <span class="keyword">if</span> (qd &lt; line[l]) sum[o] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span> sum[o] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    init(l, mid, o &lt;&lt; <span class="number">1</span>);</div><div class="line">    init(mid + <span class="number">1</span>, r, o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</div><div class="line">    pushup(l, r, o);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    pushdown(l, r, o);</div><div class="line">    <span class="keyword">if</span> (qx &lt;= l &amp;&amp; r &lt;= qy)&#123;</div><div class="line">        <span class="built_in">set</span>[o] = qd;</div><div class="line">        sum[o] = (r - l + <span class="number">1</span>) * <span class="built_in">set</span>[o];</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (qx &lt;= mid) modify(l, mid, o &lt;&lt; <span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> (qy &gt; mid) modify(mid + <span class="number">1</span>, r, o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</div><div class="line">    pushup(l, r, o);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> o)</span></span>&#123;</div><div class="line">    pushdown(l, r, o);</div><div class="line">    <span class="keyword">if</span> (qx &lt;= l &amp;&amp; r &lt;= qy) <span class="keyword">return</span> sum[o];</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (qx &lt;= mid) ans += get(l, mid, o &lt;&lt; <span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> (qy &gt; mid) ans += get(mid + <span class="number">1</span>, r, o &lt;&lt; <span class="number">1</span> | <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    qd = x;</div><div class="line">    init(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (save[i].op)&#123;</div><div class="line">            qx = save[i].l, qy = save[i].r;</div><div class="line">            <span class="keyword">int</span> num = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">            qx = save[i].l, qy = qx + num - <span class="number">1</span>, qd = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (qx &lt;= qy) modify(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">            qx = qy + <span class="number">1</span>, qy = save[i].r, qd = <span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span> (qx &lt;= qy) modify(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span>&#123;</div><div class="line">            qx = save[i].l, qy = save[i].r;</div><div class="line">            <span class="keyword">int</span> num = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">            qx = qy - num + <span class="number">1</span>, qy = save[i].r, qd = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span> (qx &lt;= qy) modify(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">            qx = save[i].l, qy = qy - num, qd = <span class="number">0</span>;</div><div class="line">            <span class="keyword">if</span> (qx &lt;= qy) modify(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    qx = qy = q;</div><div class="line">    <span class="keyword">int</span> judgement = get(<span class="number">1</span>, n, <span class="number">1</span>);</div><div class="line">    <span class="keyword">if</span> (judgement == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</div><div class="line">    <span class="keyword">int</span> mid = ((r - l) &gt;&gt; <span class="number">1</span>) + l;</div><div class="line">    <span class="keyword">if</span> (judge(mid)) <span class="keyword">return</span> work(l, mid);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">return</span> work(mid + <span class="number">1</span>, r);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> op, l, r;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;line[i]);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;op, &amp;l, &amp;r), save[i] = mod(op, l, r);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, work(<span class="number">1</span>, n));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 4281. -- [ONTAK2015]Związek Harcerstwa Bajtockiego</title><center><h2>4281: [ONTAK2015]Związek Harcerstwa Bajtockiego</h2><span class="green">Time Limit: </span>10 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>256 MB<br><span class="green">Submit: </span>207&nbsp;&nbsp;<span class="green">Solved: </span>87<br>[<a href="submitpage.php?id=4281">Submit</a>][<a href="problemstatus.php?id=4281">Status</a>][<a href="bbs.php?id=4281">Discuss</a>]</center></p><h3>Description</h3><div class="content"><div>给定一棵有n个点的无根树，相邻的点之间的距离为1，一开始你位于m点。之后你将依次收到k个指令，每个指令包含两个整数d和t，你需要沿着最短路在t步之内（包含t步）走到d点，如果不能走到，则停在最后到达的那个点。请在每个指令之后输出你所在的位置。</div><p></p>
<div></div>
<p></p></div><h3>Input</h3><div class="content"><div>第一行包含三个正整数n,m,k(1&lt;=m&lt;=n&lt;=1000000,1&lt;=k&lt;=1000000)。</div>
<div>接下来n-1行，每行包含两个正整数x,y(1&lt;=x,y&lt;=n)，描述一条树边。</div>
<div>接下来k行，每行两个整数d,t(1&lt;=d&lt;=n,0&lt;=t&lt;=10^9)，描述一条指令。</div>
<div></div>
<p></p></div><h3>Output</h3><div class="content"><div>输出一行，包含k个正整数，即执行每条指令后你所在的位置。</div>
<div></div>
<p></p></div><h3>Sample Input</h3>
<div class="content"><span class="sampledata">3 1 2<br>
1 2<br>
2 3<br>
3 4<br>
1 1</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">3 2</span></div><h3>HINT</h3>
<div class="content"><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search=By Claris">By Claris</a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>树</li>
<li>LCA问题</li>
<li>模拟</li>
</ul>
<hr>
<h2 id="题目分析-7"><a href="#题目分析-7" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>模拟操作问题</strong><br>我们只需要倍增预处理祖先然后直接模拟跑LCA即可。。。</p>
<h2 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n, m, k;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></div><div class="line">    <span class="keyword">int</span> next, to;</div><div class="line">    edge(<span class="keyword">int</span> next, <span class="keyword">int</span> to) : next(next), to(to)&#123;&#125;</div><div class="line">    edge()&#123;&#125;</div><div class="line">&#125;e[maxn &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> h[maxn], cnt = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add_Edge</span><span class="params">(<span class="keyword">int</span> fr, <span class="keyword">int</span> to)</span></span>&#123;</div><div class="line">    e[++cnt] = edge(h[fr], to);</div><div class="line">    h[fr] = cnt;</div><div class="line">    e[++cnt] = edge(h[to], fr);</div><div class="line">    h[to] = cnt;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> fa[maxn][<span class="number">25</span>];</div><div class="line"><span class="keyword">int</span> d[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">25</span>; i++) fa[x][i] = fa[fa[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = h[x]; i; i = e[i].next)&#123;</div><div class="line">        <span class="keyword">int</span> op = e[i].to;</div><div class="line">        <span class="keyword">if</span> (op == fa[x][<span class="number">0</span>]) <span class="keyword">continue</span>;</div><div class="line">        fa[op][<span class="number">0</span>] = x;</div><div class="line">        d[op] = d[x] + <span class="number">1</span>;</div><div class="line">        DFS(op);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> lca;</div><div class="line">    <span class="keyword">if</span> (d[x] &lt; d[y]) swap(x, y);</div><div class="line">    <span class="keyword">int</span> k = d[x] - d[y];</div><div class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (k)&#123;</div><div class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) x = fa[x][now];</div><div class="line">        now++;</div><div class="line">        k &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</div><div class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;</div><div class="line">        now = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (fa[x][now] != fa[y][now]) now++;</div><div class="line">        <span class="keyword">if</span> (now == <span class="number">0</span>) <span class="keyword">return</span> fa[x][<span class="number">0</span>];</div><div class="line">        now--;</div><div class="line">        x = fa[x][now];</div><div class="line">        y = fa[y][now];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> lca = find_lca(x, y);</div><div class="line">    <span class="keyword">int</span> all = d[x] + d[y] - <span class="number">2</span> * d[lca];</div><div class="line">    <span class="keyword">if</span> (v &gt;= all) <span class="keyword">return</span> y;</div><div class="line">    <span class="keyword">if</span> (v &lt;= d[x] - d[lca])&#123;</div><div class="line">        <span class="keyword">int</span> now = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (v)&#123;</div><div class="line">            <span class="keyword">if</span> (v &amp; <span class="number">1</span>) x = fa[x][now];</div><div class="line">            now++;</div><div class="line">            v &gt;&gt;= <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> x;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</div><div class="line">    v = all - v;</div><div class="line">    <span class="keyword">while</span> (v)&#123;</div><div class="line">        <span class="keyword">if</span> (v &amp; <span class="number">1</span>) y = fa[y][now];</div><div class="line">        now++;</div><div class="line">        v &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> ans;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;k);</div><div class="line">    <span class="keyword">int</span> x, y;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n - <span class="number">1</span>; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">        Add_Edge(x, y);</div><div class="line">    &#125;</div><div class="line">    d[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">    fa[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    DFS(<span class="number">1</span>);</div><div class="line">    ans = m;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">        ans = move(ans, x, y);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 3670. -- [Noi2014]动物园</title><center><h2>3670: [Noi2014]动物园</h2><span class="green">Time Limit: </span>10 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>512 MB<br><span class="green">Submit: </span>2935&nbsp;&nbsp;<span class="green">Solved: </span>1587<br>[<a href="submitpage.php?id=3670">Submit</a>][<a href="problemstatus.php?id=3670">Status</a>][<a href="bbs.php?id=3670">Discuss</a>]</center></p><h3>Description</h3><div class="content"><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">近日，园长发现动物园中好吃懒做的动物越来越多了。例如企鹅，只会卖萌向游客要吃的。为了整治动物园的不良风气，让动物们凭自己的真才实学向游客要吃的，园长决定开设算法班，让动物们学习算法。</span></span><span lang="EN-US"><o:p></o:p></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">某天，园长给动物们讲解</span><span lang="EN-US">KMP</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">算法。</span></span><span lang="EN-US"><o:p></o:p></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">园长：&ldquo;对于一个字符串</span><span lang="EN-US">S</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">，它的长度为</span><span lang="EN-US">L</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">。我们可以在</span><span lang="EN-US">O(L)</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">的时间内，求出一个名为</span><span lang="EN-US">next</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">的数组。有谁预习了</span><span lang="EN-US">next</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">数组的含义吗？&rdquo;</span></span><span lang="EN-US"><o:p></o:p></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">熊猫：&ldquo;对于字符串</span><span lang="EN-US">S</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">的前</span><span lang="EN-US">i</span></span><span lang="EN-US" style="font-size: 10.5pt; font-family: &quot;calibri&quot;,&quot;sans-serif&quot;; position: relative; top: 5.5pt; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'timesnewroman'; mso-bidi-theme-font: minor-bidi; mso-text-raise: -5.5pt; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"><v:stroke joinstyle="miter"><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"><v:f eqn="sum @0 1 0"><v:f eqn="sum 0 0 @1"><v:f eqn="prod @2 1 2"><v:f eqn="prod @3 21600 pixelWidth"><v:f eqn="prod @3 21600 pixelHeight"><v:f eqn="sum @0 0 1"><v:f eqn="prod @6 1 2"><v:f eqn="prod @7 21600 pixelWidth"><v:f eqn="sum @8 21600 0"><v:f eqn="prod @7 21600 pixelHeight"><v:f eqn="sum @10 21600 0"></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"><o:lock v:ext="edit" aspectratio="t"></o:lock></v:path></v:stroke></v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style="width: 3pt; height: 18.75pt"><v:imagedata src="file:///C:%5CUsers%5C%E6%9C%8B%E9%A3%9E%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_image001.png" o:title="" chromakey="white"></v:imagedata></v:shape></span><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">个字符构成的子串，既是它的后缀又是它的前缀的字符串中（它本身除外），最长的长度记作</span><span lang="EN-US"><font face="宋体, MS Song">next[i]</font></span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">。&rdquo;</span></span><font size="3"><span lang="EN-US"><o:p></o:p></span></font></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">园长：&ldquo;非常好！那你能举个例子吗？&rdquo;</span></span><span lang="EN-US"><o:p></o:p></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">熊猫：&ldquo;例</span><span lang="EN-US">S</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">为</span><u><span lang="EN-US">abcababc</span></u><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">，则</span><span lang="EN-US">next[5]=2</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">。因为</span><span lang="EN-US">S</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">的前</span><span lang="EN-US">5</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">个字符为</span><u><span lang="EN-US">abcab</span></u><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">，</span><u><span lang="EN-US">ab</span></u><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">既是它的后缀又是它的前缀，并且找不到一个更长的字符串满足这个性质。同理，还可得出</span><span lang="EN-US">next[1] = next[2] = next[3] = 0</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US">next[4] = next[6] = 1</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US">next[7] = 2</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">，</span><span lang="EN-US">next[8] = 3</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">。&rdquo;</span></span><span lang="EN-US"><o:p></o:p></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">园长表扬了认真预习的熊猫同学。随后，他详细讲解了如何在</span><span lang="EN-US">O(L)</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">的时间内求出</span><span lang="EN-US">next</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">数组。</span></span><span lang="EN-US"><o:p></o:p></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">下课前，园长提出了一个问题：&ldquo;</span><span lang="EN-US">KMP</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">算法只能求出<span lang="EN-US">next</span>数组。我现在希望求出</span><span style="line-height: 1.5; font-family: 宋体">一</span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">个更强大</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5">num</span></span><span lang="EN-US" style="font-size: 10.5pt; text-indent: 24pt; font-family: calibri, sans-serif; position: relative; top: 5.5pt"><v:shape id="_x0000_i1025" type="#_x0000_t75" style="width: 3pt; height: 18.75pt"><v:imagedata src="file:///C:%5CUsers%5C%E6%9C%8B%E9%A3%9E%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_image001.png" o:title="" chromakey="white"></v:imagedata></v:shape></span><span style="font-size: medium"><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">数组一一对于字符串S的前i个字符构成的子串，既是它的后缀同时又是它的前缀，并且该后缀与该前缀不重叠，将这种字符串的数量记作</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5"><font face="宋体, MS Song">num[i]</font></span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">。例如</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5"><font face="宋体, MS Song">S</font></span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">为</span><u style="text-indent: 24pt; line-height: 1.5"><span lang="EN-US"><font face="宋体, MS Song">aaaaa</font></span></u><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">，则</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5"><font face="宋体, MS Song">num[4] = 2</font></span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">。这是因为</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5"><font face="宋体, MS Song">S</font></span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">的前</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5"><font face="宋体, MS Song">4</font></span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">个字符为</span><u style="text-indent: 24pt; line-height: 1.5"><span lang="EN-US"><font face="宋体, MS Song">aaaa</font></span></u><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">，其中</span><u style="text-indent: 24pt; line-height: 1.5"><span lang="EN-US"><font face="宋体, MS Song">a</font></span></u><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">和</span><u style="text-indent: 24pt; line-height: 1.5"><span lang="EN-US"><font face="宋体, MS Song">aa</font></span></u><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">都满足性质&lsquo;既是后缀又是前缀&rsquo;，同时保证这个后缀与这个前缀不重叠。而</span><u style="text-indent: 24pt; line-height: 1.5"><span lang="EN-US"><font face="宋体, MS Song">aaa</font></span></u><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">虽然满足性质&lsquo;既是后缀又是前缀&rsquo;，但遗憾的是这个后缀与这个前缀重叠了，所以不能计算在内。同理，</span><span lang="EN-US" style="text-indent: 24pt; line-height: 1.5"><font face="宋体, MS Song">num[1] = 0,num[2] = num[3] = 1,num[5] = 2</font></span><span style="text-indent: 24pt; line-height: 1.5; font-family: 宋体">。&rdquo;</span></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">最后，园长给出了奖励条件，第一个做对的同学奖励巧克力一盒。听了这句话，睡了一节课的企鹅立刻就醒过来了！但企鹅并不会做这道题，于是向参观动物园的你寻求帮助。你能否帮助企鹅写一个程序求出</span><span lang="EN-US">num</span></span><span lang="EN-US" style="font-size: 10.5pt; font-family: &quot;calibri&quot;,&quot;sans-serif&quot;; position: relative; top: 5.5pt; mso-bidi-font-size: 11.0pt; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: 'timesnewroman'; mso-bidi-theme-font: minor-bidi; mso-text-raise: -5.5pt; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA"><v:shape id="_x0000_i1025" type="#_x0000_t75" style="width: 3pt; height: 18.75pt"><v:imagedata src="file:///C:%5CUsers%5C%E6%9C%8B%E9%A3%9E%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_image001.png" o:title="" chromakey="white"></v:imagedata></v:shape></span><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">数组呢？</span></span><font size="3"><span lang="EN-US"><o:p></o:p></span></font></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'timesnewroman'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: 'timesnewroman'; mso-ansi-language: en-us; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-font-kerning: 1.0pt">特别地，为了避免大量的输出，你不需要输出</span><span lang="EN-US" style="font-family: &quot;timesnewroman&quot;,&quot;serif&quot;; mso-bidi-font-size: 10.0pt; mso-fareast-font-family: 宋体; mso-ansi-language: EN-US; mso-fareast-language: ZH-CN; mso-bidi-language: AR-SA; mso-font-kerning: 1.0pt">num[i]</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'timesnewroman'; mso-bidi-font-size: 10.0pt; mso-bidi-font-family: 'timesnewroman'; mso-ansi-language: EN-US; mso-fareast-language: zh-cn; mso-bidi-language: AR-SA; mso-font-kerning: 1.0pt">分别是多少，你只需要输出<img height="36" alt="" width="144" src="/JudgeOnline/upload/201407/11(4).jpg"></span><span style="font-family: 宋体">对</span><span lang="EN-US" style="font-family: 'Times New Roman', serif">1,000,000,007</span></span><span lang="EN-US" style="font-size: 10.5pt; font-family: 'Times New Roman', serif; position: relative; top: 2.5pt"><v:shapetype id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f"><v:stroke joinstyle="miter"><v:formulas><v:f eqn="if lineDrawn pixelLineWidth 0"><v:f eqn="sum @0 1 0"><v:f eqn="sum 0 0 @1"><v:f eqn="prod @2 1 2"><v:f eqn="prod @3 21600 pixelWidth"><v:f eqn="prod @3 21600 pixelHeight"><v:f eqn="sum @0 0 1"><v:f eqn="prod @6 1 2"><v:f eqn="prod @7 21600 pixelWidth"><v:f eqn="sum @8 21600 0"><v:f eqn="prod @7 21600 pixelHeight"><v:f eqn="sum @10 21600 0"></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:formulas><v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"><o:lock v:ext="edit" aspectratio="t"></o:lock></v:path></v:stroke></v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" style="width: 2.25pt; height: 12pt"><v:imagedata src="file:///C:%5CUsers%5C%E6%9C%8B%E9%A3%9E%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_image001.png" o:title="" chromakey="white"></v:imagedata></v:shape></span><span style="font-size: medium"><span style="font-family: 宋体">取模的结果即可。</span></span></p><p></p>
<p></p><p class="NOI" style="margin: 2.4pt 0cm; text-indent: 24pt"><span style="font-size: medium"><span style="font-family: 宋体"><img height="36" alt="" width="541" src="/JudgeOnline/upload/201407/22(2).jpg"></span></span></p>&lt;/div&gt;<h3>Input</h3><div class="content"><p><span style="font-size: medium">第1行仅包含一个正整数n ，表示测试数据的组数。随后n行，每行描述一组测试数据。每组测试数据仅含有一个字符串S，S的定义详见题目描述。数据保证S 中仅含小写字母。输入文件中不会包含多余的空行，行末不会存在多余的空格。</span></p></div><h3>Output</h3><div class="content"><p><span style="font-size: medium">包含 n 行，每行描述一组测试数据的答案，答案的顺序应与输入数据的顺序保持一致。对于每组测试数据，仅需要输出一个整数，表示这组测试数据的答案对 1,000,000,007 取模的结果。输出文件中不应包含多余的空行。 </span></p></div><h3>Sample Input</h3><p></p>
<div class="content"><span class="sampledata">3<br>
aaaaa<br>
ab<br>
abcababc</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">36<br>
1<br>
32 </span></div><h3>HINT</h3>
<div class="content"><p></p><p><span lang="EN-US">n</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">&le;</span><span lang="EN-US">5,L</span><span style="font-family: 宋体; mso-ascii-font-family: 'timesnewroman'; mso-hansi-font-family: 'Times New Roman'">&le;</span><span lang="EN-US">1,000,000</span></p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search="></a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>字符串</li>
<li>KMP变式</li>
</ul>
<hr>
<h2 id="题目分析-8"><a href="#题目分析-8" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>KMP变式问题</strong></p>
<p>这道题其实是一道很好的题目，能加强对KMP的理解</p>
<p>其实fail函数有两种实现，一种是代表包含自己前一个位置但不含自己的最长border长度，另一种是自己也算在内的最长border长度</p>
<p>这两者的处理方式并不相同，所以一定要想清楚KMP的原理</p>
<h2 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 1000000007</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long int</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">char</span> t[maxn];</div><div class="line"><span class="keyword">int</span> lent;</div><div class="line"><span class="keyword">int</span> f[maxn];</div><div class="line"><span class="keyword">int</span> f1[maxn];</div><div class="line"><span class="keyword">int</span> num[maxn];</div><div class="line"><span class="keyword">int</span> f2[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">    f[<span class="number">0</span>] = <span class="number">-1</span>;</div><div class="line">    f1[<span class="number">0</span>] = <span class="number">-1</span>;</div><div class="line">    num[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; lent; i++)&#123;</div><div class="line">        <span class="keyword">int</span> k = f[i - <span class="number">1</span>];</div><div class="line">        <span class="keyword">while</span> (k &gt; <span class="number">-1</span> &amp;&amp; t[k + <span class="number">1</span>] != t[i]) k = f[k];</div><div class="line">        f[i] = ((t[k + <span class="number">1</span>] == t[i]) ? k + <span class="number">1</span> : <span class="number">-1</span>);</div><div class="line">        num[i] = ((t[k + <span class="number">1</span>] == t[i]) ? num[k + <span class="number">1</span>] + <span class="number">1</span> : <span class="number">0</span>);</div><div class="line"></div><div class="line">        k = f1[i - <span class="number">1</span>];</div><div class="line">        <span class="keyword">while</span> (k &gt; <span class="number">-1</span> &amp;&amp; t[k + <span class="number">1</span>] != t[i]) k = f[k];</div><div class="line">        f1[i] = ((t[k + <span class="number">1</span>] == t[i]) ? k + <span class="number">1</span> : <span class="number">-1</span>);</div><div class="line">        <span class="keyword">while</span> (f1[i] &gt; <span class="number">-1</span> &amp;&amp; ((f1[i] + <span class="number">1</span>) &lt;&lt; <span class="number">1</span>) &gt; i + <span class="number">1</span>) f1[i] = f[f1[i]];</div><div class="line"></div><div class="line">        f2[i] = (f1[i] == <span class="number">-1</span>) ? <span class="number">0</span> : (num[f1[i]] + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>&#123;</div><div class="line">    LL ans = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lent; i++) ans = ans * (f2[i] + <span class="number">1</span>) % M;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, t);</div><div class="line">        lent = <span class="built_in">strlen</span>(t);</div><div class="line">        init();</div><div class="line">        work();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><title>Problem 3530. -- [Sdoi2014]数数</title><center><h2>3530: [Sdoi2014]数数</h2><span class="green">Time Limit: </span>10 Sec&nbsp;&nbsp;<span class="green">Memory Limit: </span>512 MB<br><span class="green">Submit: </span>1082&nbsp;&nbsp;<span class="green">Solved: </span>555<br>[<a href="submitpage.php?id=3530">Submit</a>][<a href="problemstatus.php?id=3530">Status</a>][<a href="bbs.php?id=3530">Discuss</a>]</center></p><h3>Description</h3><div class="content"><p><span style="font-size: medium">我们称一个正整数N是幸运数，当且仅当它的十进制表示中不包含数字串集合S中任意一个元素作为其子串。例如当S=(22，333，0233)时，233是幸运数，2333、20233、3223不是幸运数。<br>
&nbsp;&nbsp;&nbsp; 给定N和S，计算不大于N的幸运数个数。<br>
</span></p></div><h3>Input</h3><div class="content"><p><br></p>
<p><font size="4">&nbsp;&nbsp;&nbsp; 输入的第一行包含整数N。<br><br>&nbsp;&nbsp;&nbsp; 接下来一行一个整数M，表示S中元素的数量。<br><br>&nbsp;&nbsp;&nbsp; 接下来M行，每行一个数字串，表示S中的一个元素。<br>
</font>&lt;/p&gt;&lt;/div&gt;</p><h3>Output</h3><div class="content"><p><font size="4">&nbsp;&nbsp;&nbsp; 输出一行一个整数，表示答案模109+7的值。<br>
</font></p></div><h3>Sample Input</h3><p></p>
<div class="content"><span class="sampledata">    20<br>
    3<br>
    2<br>
    3<br>
    14<br>
</span></div><h3>Sample Output</h3>
<div class="content"><span class="sampledata">    14</span></div><h3>HINT</h3>
<div class="content"><p></p><p><span style="font-size: medium">&nbsp;下表中l表示N的长度，L表示S中所有串长度之和。</span></p><br>
<p><span style="font-size: medium">1 &lt; =l &lt; =1200&nbsp;, 1 &lt; =M &lt; =100&nbsp;,1 &lt; =L &lt; =1500</span></p><p></p></div><h3>Source</h3>
<div class="content"><p><a href="problemset.php?search=Round 1 day 1">Round 1 day 1</a></p></div>

<hr>
<p><strong>Tags</strong>:</p>
<ul>
<li>动态规划</li>
<li>数位DP</li>
<li>AC自动机</li>
</ul>
<hr>
<h2 id="题目分析-9"><a href="#题目分析-9" class="headerlink" title="题目分析"></a>题目分析</h2><p><strong>多串匹配型数位DP问题</strong></p>
<p>本题首先显然是AC自动机，然而情况多，真的很难一遍写对。。。</p>
<p>大概的坑有如下：</p>
<ul>
<li>集合中的数字开头可以为0</li>
<li>AC自动机中可能包含其他串的结点也不能走到</li>
<li>要注意开始标记的作用，为了避免，要循环累计答案</li>
</ul>
<p>另外本题LOJ数据弱，第二点没处理也能过，然而BZOJ上就过不了。。。</p>
<p>好了不说了。。。</p>
<h2 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 4005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> M 1000000007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">bool</span> val[maxn];</div><div class="line"><span class="keyword">int</span> ch[maxn][<span class="number">12</span>];</div><div class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> f[maxn];</div><div class="line"><span class="keyword">char</span> s[maxn];</div><div class="line"><span class="keyword">int</span> m;</div><div class="line"><span class="keyword">char</span> num[maxn];</div><div class="line"><span class="keyword">int</span> ct = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> len;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">int</span> now = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (!ch[now][s[i] - <span class="string">'0'</span>]) ch[now][s[i] - <span class="string">'0'</span>] = ++cnt;</div><div class="line">        now = ch[now][s[i] - <span class="string">'0'</span>];</div><div class="line">    &#125;</div><div class="line">    val[now] = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</div><div class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; bfs;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>][i]) f[ch[<span class="number">0</span>][i]] = <span class="number">0</span>, bfs.push(ch[<span class="number">0</span>][i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (!bfs.empty())&#123;</div><div class="line">        <span class="keyword">int</span> op = bfs.front(); bfs.pop();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</div><div class="line">            <span class="keyword">if</span> (!ch[op][i]) ch[op][i] = ch[f[op]][i];</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">int</span> k = f[op];</div><div class="line">                <span class="keyword">while</span> (k &amp;&amp; !ch[k][i]) k = f[k];</div><div class="line">                f[ch[op][i]] = (!ch[k][i]) ? <span class="number">0</span> : ch[k][i];</div><div class="line">                <span class="keyword">if</span> (val[f[ch[op][i]]]) val[ch[op][i]] = <span class="number">1</span>;</div><div class="line">                bfs.push(ch[op][i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    ct = <span class="built_in">strlen</span>(num);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ct; i++) num[i] -= <span class="string">'0'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> dp[maxn][maxn][<span class="number">2</span>];</div><div class="line"><span class="keyword">bool</span> vis[maxn][maxn][<span class="number">2</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DP</span><span class="params">(<span class="keyword">int</span> pos, <span class="keyword">int</span> loc, <span class="keyword">int</span> op)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> (val[loc]) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (pos == ct) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (vis[pos][loc][op]) <span class="keyword">return</span> dp[pos][loc][op];</div><div class="line">    vis[pos][loc][op] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span>&amp; ans = dp[pos][loc][op];</div><div class="line">    <span class="keyword">if</span> (op)&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num[pos]; i++)&#123;</div><div class="line">            ans = (ans + DP(pos + <span class="number">1</span>, ch[loc][i], <span class="number">0</span>)) % M;</div><div class="line">        &#125;</div><div class="line">        ans = (ans + DP(pos + <span class="number">1</span>, ch[loc][num[pos]], <span class="number">1</span>)) % M;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)&#123;</div><div class="line">        ans = (ans + DP(pos + <span class="number">1</span>, ch[loc][i], <span class="number">0</span>)) % M;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%d"</span>, num, &amp;m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">        len = <span class="built_in">strlen</span>(s);</div><div class="line">        insert();</div><div class="line">    &#125;</div><div class="line">    init();</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; ct; i++)&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">10</span>; j++)&#123;</div><div class="line">            ans = (ans + DP(i + <span class="number">1</span>, ch[<span class="number">0</span>][j], <span class="number">0</span>)) % M;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; num[<span class="number">0</span>]; i++) ans = (ans + DP(<span class="number">1</span>, ch[<span class="number">0</span>][i], <span class="number">0</span>)) % M;</div><div class="line">    ans = (ans + DP(<span class="number">1</span>, ch[<span class="number">0</span>][num[<span class="number">0</span>]], <span class="number">1</span>)) % M;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本期的题型有：</p>
<ul>
<li><strong>模数数位DP问题</strong></li>
<li><strong>树上动态维护问题</strong></li>
<li><strong>图上两点瓶颈路问题</strong></li>
<li><strong>线段树合并问题</strong></li>
<li><strong>动点SPFA/二维瓶颈路问题</strong></li>
<li><strong>质因子分析DFS问题</strong></li>
<li><strong>线段树特殊操作问题</strong></li>
<li><strong>模拟操作问题</strong></li>
<li><strong>KMP变式问题</strong></li>
<li><strong>多串匹配型数位DP问题</strong></li>
</ul>
</div></div></div></div></div>
            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/BZOJ/">BZOJ</a> <a class="tag tag--primary tag--small t-link" href="/tags/题解/">题解</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/09/07/BZOJ阶段性汇总VI/"  data-tooltip="BZOJ阶段性汇总VI">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/09/07/BZOJ阶段性汇总IV/" data-tooltip="BZOJ阶段性汇总IV">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/&amp;title=BZOJ阶段性汇总V">
                    <i class="fa fa-qq"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-star"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-renren"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 Renatus. All Rights Reserved.
    </span>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/09/07/BZOJ阶段性汇总VI/"  data-tooltip="BZOJ阶段性汇总VI">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/09/07/BZOJ阶段性汇总IV/" data-tooltip="BZOJ阶段性汇总IV">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-facebook-official"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-twitter"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-google-plus"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/&amp;title=BZOJ阶段性汇总V">
                    <i class="fa fa-qq"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-star"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-renren"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#table-of-contents">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-facebook-official"></i><span>分享到 Facebook</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-twitter"></i><span>分享到 Twitter</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-google-plus"></i><span>分享到 Google+</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://connect.qq.com/widget/shareqq/index.html?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/&amp;title=BZOJ阶段性汇总V">
                    <i class="fa fa-qq"></i><span>分享到 QQ</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-star"></i><span>分享到 Qzone</span>
                </a>
            </li>
        
            
            
            <li class="share-option">
                <a class="share-option-btn" target="new" href="http://widget.renren.com/dialog/share?resourceUrl=https://gqh123.github.io/2017/09/07/BZOJ阶段性汇总V/">
                    <i class="fa fa-renren"></i><span>分享到 Renren</span>
                </a>
            </li>
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/2016-02-23.png" alt="作者的图片"/>
        
            <h4 id="about-card-name">Renatus</h4>
        
            <div id="about-card-bio"><p>For what I cherish forever.</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Fudan’s ACMer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                China, Shanghai, Fudan University
            </div>
        
    </div>
</div>

        <div id="algolia-search-modal" class="modal-container">
    <div class="modal">
        <div class="modal-header">
            <span class="close-button"><i class="fa fa-close"></i></span>
            <a href="https://www.algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
                <img class="searchby-algolia-logo" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNjgiIGhlaWdodD0iMjQiPjxnIGZpbGw9Im5vbmUiPjxwYXRoIGZpbGw9IiM1NDY4RkYiIGQ9Ik03OC45ODguOTM4aDE2LjU5NGEyLjk2OCAyLjk2OCAwIDAgMSAyLjk2NiAyLjk2NlYyMC41YTIuOTY3IDIuOTY3IDAgMCAxLTIuOTY2IDIuOTY0SDc4Ljk4OGEyLjk2NyAyLjk2NyAwIDAgMS0yLjk2Ni0yLjk2NFYzLjg5N0EyLjk2MSAyLjk2MSAwIDAgMSA3OC45ODguOTM4em00MS45MzcgMTcuODY2Yy00LjM4Ni4wMi00LjM4Ni0zLjU0LTQuMzg2LTQuMTA2bC0uMDA3LTEzLjMzNiAyLjY3NS0uNDI0djEzLjI1NGMwIC4zMjIgMCAyLjM1OCAxLjcxOCAyLjM2NHYyLjI0OHptLTEwLjg0Ni0yLjE4Yy44MjEgMCAxLjQzLS4wNDcgMS44NTUtLjEyOXYtMi43MTlhNi4zMzQgNi4zMzQgMCAwIDAtMS41NzQtLjE5OSA1LjcgNS43IDAgMCAwLS44OTcuMDY5IDIuNjk5IDIuNjk5IDAgMCAwLS44MTQuMjRjLS4yNC4xMTYtLjQzOS4yOC0uNTgyLjQ5MS0uMTUuMjEyLS4yMTkuMzM1LS4yMTkuNjU2IDAgLjYyOC4yMTkuOTkxLjYxNiAxLjIzcy45MzguMzYyIDEuNjE1LjM2MnptLS4yMzMtOS43Yy44ODMgMCAxLjYyOS4xMDkgMi4yMzEuMzI4LjYwMi4yMTggMS4wODguNTI1IDEuNDQ0LjkxNS4zNjMuMzk2LjYwOS45MjIuNzYgMS40ODMuMTU3LjU2LjIzMiAxLjE3NS4yMzIgMS44NXY2Ljg3NGEzMi41IDMyLjUgMCAwIDEtMS44NjguMzE0Yy0uODM0LjEyMy0xLjc3Mi4xODUtMi44MTMuMTg1LS42OSAwLTEuMzI3LS4wNjktMS44OTUtLjE5OGE0LjAwMSA0LjAwMSAwIDAgMS0xLjQ3MS0uNjM2IDMuMDg1IDMuMDg1IDAgMCAxLS45NTEtMS4xMzRjLS4yMjYtLjQ2NS0uMzQzLTEuMTItLjM0My0xLjgwMyAwLS42NTYuMTMtMS4wNzMuMzg0LTEuNTI1YTMuMjQgMy4yNCAwIDAgMSAxLjA0Ny0xLjEwNmMuNDQ1LS4yODcuOTUtLjQ5MiAxLjUzMi0uNjE1YTguOCA4LjggMCAwIDEgMS44Mi0uMTg1IDguNDA0IDguNDA0IDAgMCAxIDEuOTcyLjI0di0uNDM4YzAtLjMwNy0uMDM1LS42LS4xMS0uODc0YTEuODggMS44OCAwIDAgMC0uMzg0LS43MyAxLjc4NCAxLjc4NCAwIDAgMC0uNzI0LS40OTMgMy4xNjQgMy4xNjQgMCAwIDAtMS4xNDMtLjIwNWMtLjYxNiAwLTEuMTc3LjA3NS0xLjY5LjE2NGE3LjczNSA3LjczNSAwIDAgMC0xLjI2LjMwN2wtLjMyMS0yLjE5MmMuMzM1LS4xMTcuODM0LS4yMzMgMS40NzgtLjM0OWExMC45OCAxMC45OCAwIDAgMSAyLjA3My0uMTc4em01Mi44NDIgOS42MjZjLjgyMiAwIDEuNDMtLjA0OCAxLjg1NC0uMTNWMTMuN2E2LjM0NyA2LjM0NyAwIDAgMC0xLjU3NC0uMTk5Yy0uMjk0IDAtLjU5NS4wMjEtLjg5Ni4wNjlhMi43IDIuNyAwIDAgMC0uODE0LjI0IDEuNDYgMS40NiAwIDAgMC0uNTgyLjQ5MWMtLjE1LjIxMi0uMjE4LjMzNS0uMjE4LjY1NiAwIC42MjguMjE4Ljk5MS42MTUgMS4yMy40MDQuMjQ1LjkzOC4zNjIgMS42MTUuMzYyem0tLjIyNi05LjY5NGMuODgzIDAgMS42MjkuMTA4IDIuMjMxLjMyNy42MDIuMjE5IDEuMDg4LjUyNiAxLjQ0NC45MTUuMzU1LjM5LjYwOS45MjMuNzU5IDEuNDgzYTYuOCA2LjggMCAwIDEgLjIzMyAxLjg1MnY2Ljg3M2MtLjQxLjA4OC0xLjAzNC4xOS0xLjg2OC4zMTQtLjgzNC4xMjMtMS43NzIuMTg0LTIuODEzLjE4NC0uNjkgMC0xLjMyNy0uMDY4LTEuODk1LS4xOThhNC4wMDEgNC4wMDEgMCAwIDEtMS40NzEtLjYzNSAzLjA4NSAzLjA4NSAwIDAgMS0uOTUxLTEuMTM0Yy0uMjI2LS40NjUtLjM0My0xLjEyLS4zNDMtMS44MDQgMC0uNjU2LjEzLTEuMDczLjM4NC0xLjUyNC4yNi0uNDUuNjA4LS44MiAxLjA0Ny0xLjEwNy40NDUtLjI4Ni45NS0uNDkxIDEuNTMyLS42MTRhOC44MDMgOC44MDMgMCAwIDEgMi43NTEtLjEzYy4zMjkuMDM0LjY3MS4wOTYgMS4wNC4xODV2LS40MzdhMy4zIDMuMyAwIDAgMC0uMTA5LS44NzUgMS44NzMgMS44NzMgMCAwIDAtLjM4NC0uNzMxIDEuNzg0IDEuNzg0IDAgMCAwLS43MjQtLjQ5MiAzLjE2NSAzLjE2NSAwIDAgMC0xLjE0My0uMjA1Yy0uNjE2IDAtMS4xNzcuMDc1LTEuNjkuMTY0YTcuNzUgNy43NSAwIDAgMC0xLjI2LjMwN2wtLjMyMS0yLjE5M2MuMzM1LS4xMTYuODM0LS4yMzIgMS40NzgtLjM0OGExMS42MzMgMTEuNjMzIDAgMCAxIDIuMDczLS4xNzd6bS04LjAzNC0xLjI3MWExLjYyNiAxLjYyNiAwIDAgMS0xLjYyOC0xLjYyYzAtLjg5NS43MjUtMS42MiAxLjYyOC0xLjYyLjkwNCAwIDEuNjMuNzI1IDEuNjMgMS42MiAwIC44OTUtLjczMyAxLjYyLTEuNjMgMS42MnptMS4zNDggMTMuMjJoLTIuNjg5VjcuMjdsMi42OS0uNDIzdjExLjk1NnptLTQuNzE0IDBjLTQuMzg2LjAyLTQuMzg2LTMuNTQtNC4zODYtNC4xMDdsLS4wMDgtMTMuMzM2IDIuNjc2LS40MjR2MTMuMjU0YzAgLjMyMiAwIDIuMzU4IDEuNzE4IDIuMzY0djIuMjQ4em0tOC42OTgtNS45MDNjMC0xLjE1Ni0uMjUzLTIuMTE5LS43NDYtMi43ODgtLjQ5My0uNjc3LTEuMTgzLTEuMDEtMi4wNjctMS4wMS0uODgyIDAtMS41NzQuMzMzLTIuMDY1IDEuMDEtLjQ5My42NzYtLjczMyAxLjYzMi0uNzMzIDIuNzg4IDAgMS4xNjguMjQ2IDEuOTUzLjc0IDIuNjMuNDkyLjY4MyAxLjE4MyAxLjAxOCAyLjA2NiAxLjAxOC44ODIgMCAxLjU3NC0uMzQyIDIuMDY3LTEuMDE5LjQ5Mi0uNjgzLjczOC0xLjQ2LjczOC0yLjYzem0yLjczNy0uMDA3YzAgLjkwMi0uMTMgMS41ODQtLjM5NyAyLjMzYTUuNTIgNS41MiAwIDAgMS0xLjEyOCAxLjkwNiA0Ljk4NiA0Ljk4NiAwIDAgMS0xLjc1MiAxLjIyM2MtLjY4NS4yODYtMS43MzkuNDUtMi4yNjUuNDUtLjUyOC0uMDA2LTEuNTc0LS4xNTctMi4yNTItLjQ1YTUuMDk2IDUuMDk2IDAgMCAxLTEuNzQ0LTEuMjIzYy0uNDg3LS41MjctLjg2My0xLjE2Mi0xLjEzNy0xLjkwNmE2LjM0NSA2LjM0NSAwIDAgMS0uNDEtMi4zM2MwLS45MDIuMTIzLTEuNzcuMzk3LTIuNTA4YTUuNTU0IDUuNTU0IDAgMCAxIDEuMTUtMS44OTIgNS4xMzMgNS4xMzMgMCAwIDEgMS43NS0xLjIxNmMuNjc5LS4yODcgMS40MjUtLjQyMyAyLjIzMi0uNDIzLjgwOCAwIDEuNTUzLjE0MiAyLjIzNy40MjNhNC44OCA0Ljg4IDAgMCAxIDEuNzUzIDEuMjE2IDUuNjQ0IDUuNjQ0IDAgMCAxIDEuMTM1IDEuODkyYy4yODcuNzM4LjQzMSAxLjYwNi40MzEgMi41MDh6bS0yMC4xMzggMGMwIDEuMTIuMjQ2IDIuMzYzLjczOCAyLjg4Mi40OTMuNTIgMS4xMy43OCAxLjkxLjc4LjQyNCAwIC44MjgtLjA2MiAxLjIwNC0uMTc4LjM3Ny0uMTE2LjY3Ny0uMjUzLjkxNy0uNDE3VjkuMzNhMTAuNDc2IDEwLjQ3NiAwIDAgMC0xLjc2Ni0uMjI2Yy0uOTcxLS4wMjgtMS43MS4zNy0yLjIzIDEuMDA0LS41MTMuNjM2LS43NzMgMS43NS0uNzczIDIuNzg4em03LjQzOCA1LjI3NGMwIDEuODI0LS40NjYgMy4xNTYtMS40MDQgNC4wMDQtLjkzNi44NDYtMi4zNjcgMS4yNy00LjI5NiAxLjI3LS43MDUgMC0yLjE3LS4xMzctMy4zNC0uMzk2bC40MzEtMi4xMThjLjk4LjIwNSAyLjI3Mi4yNiAyLjk1LjI2IDEuMDc0IDAgMS44NC0uMjE5IDIuMjk5LS42NTYuNDU5LS40MzcuNjg0LTEuMDg2LjY4NC0xLjk0OHYtLjQzN2E4LjA3IDguMDcgMCAwIDEtMS4wNDcuMzk3Yy0uNDMuMTMtLjkzLjE5OC0xLjQ5Mi4xOTgtLjczOSAwLTEuNDEtLjExNi0yLjAxOC0uMzQ5YTQuMjA2IDQuMjA2IDAgMCAxLTEuNTY3LTEuMDI1Yy0uNDMxLS40NS0uNzc0LTEuMDE3LTEuMDEzLTEuNjk0LS4yNC0uNjc3LS4zNjMtMS44ODUtLjM2My0yLjc3MyAwLS44MzQuMTMtMS44OC4zODQtMi41NzcuMjYtLjY5Ni42MjktMS4yOTggMS4xMjktMS43OTYuNDkzLS40OTggMS4wOTUtLjg4MSAxLjgtMS4xNjJhNi42MDUgNi42MDUgMCAwIDEgMi40MjgtLjQ1N2MuODcgMCAxLjY3LjEwOSAyLjQ1LjI0Ljc4LjEyOSAxLjQ0NC4yNjUgMS45ODUuNDE1VjE4LjE3eiIvPjxwYXRoIGZpbGw9IiM1RDY0OTQiIGQ9Ik02Ljk3MiA2LjY3N3YxLjYyN2MtLjcxMi0uNDQ2LTEuNTItLjY3LTIuNDI1LS42Ny0uNTg1IDAtMS4wNDUuMTMtMS4zOC4zOTFhMS4yNCAxLjI0IDAgMCAwLS41MDIgMS4wM2MwIC40MjUuMTY0Ljc2NS40OTQgMS4wMi4zMy4yNTYuODM1LjUzMiAxLjUxNi44My40NDcuMTkyLjc5NS4zNTYgMS4wNDUuNDk1LjI1LjEzOC41MzcuMzMyLjg2Mi41ODIuMzI0LjI1LjU2My41NDguNzE4Ljg5NC4xNTQuMzQ1LjIzLjc0MS4yMyAxLjE4OCAwIC45NDctLjMzNCAxLjY5MS0xLjAwNCAyLjIzNC0uNjcuNTQyLTEuNTM3LjgxNC0yLjYwMS44MTQtMS4xOCAwLTIuMTYtLjIyOS0yLjkzNi0uNjg2di0xLjcwOGMuODQuNjI4IDEuODE0Ljk0MiAyLjkyLjk0Mi41ODUgMCAxLjA0OC0uMTM2IDEuMzg4LS40MDcuMzQtLjI3MS41MS0uNjQ2LjUxLTEuMTI1IDAtLjI4Ny0uMS0uNTUtLjMwMi0uNzktLjIwMy0uMjQtLjQyLS40Mi0uNjU1LS41NDItLjIzNC0uMTIzLS41ODUtLjI5LTEuMDUzLS41MDNhNjEuMjcgNjEuMjcgMCAwIDEtLjU4Mi0uMjcxIDEzLjY3IDEzLjY3IDAgMCAxLS41NS0uMjg3IDQuMjc1IDQuMjc1IDAgMCAxLS41NjctLjM1MSA2LjkyIDYuOTIgMCAwIDEtLjQ1NS0uNGMtLjE4LS4xNy0uMzEtLjM0LS4zOS0uNTEtLjA4LS4xNy0uMTU1LS4zNy0uMjI0LS41OThhMi41NTMgMi41NTMgMCAwIDEtLjEwNC0uNzQyYzAtLjkxNS4zMzMtMS42MzguOTk4LTIuMTcuNjY0LS41MzIgMS41MjMtLjc5OCAyLjU3Ni0uNzk4Ljk2OCAwIDEuNzkzLjE3IDIuNDczLjUxem03LjQ2OCA1LjY5NnYtLjI4N2MtLjAyMi0uNjA3LS4xODctMS4wODgtLjQ5NS0xLjQ0NC0uMzA5LS4zNTctLjc1LS41MzUtMS4zMjQtLjUzNS0uNTMyIDAtLjk5LjE5NC0xLjM3My41ODMtLjM4Mi4zODgtLjYyMi45NDktLjcxNyAxLjY4M2gzLjkwOXptMS4wMDUgMi43OTJ2MS40MDRjLS41OTYuMzQtMS4zODMuNTEtMi4zNjIuNTEtMS4yNTUgMC0yLjI1NS0uMzc3LTMtMS4xMzItLjc0NC0uNzU1LTEuMTE2LTEuNzQ0LTEuMTE2LTIuOTY4IDAtMS4yOTcuMzQtMi4zMTYgMS4wMjEtMy4wNTUuNjgtLjc0IDEuNTQ4LTEuMTEgMi42LTEuMTEgMS4wMzMgMCAxLjg1Mi4zMjMgMi40NTguOTY2LjYwNi42NDQuOTEgMS41NzIuOTEgMi43ODQgMCAuMzMtLjAzMy42NzYtLjA5NiAxLjAzOGgtNS4zMTRjLjEwNy43MDIuNDA1IDEuMjM5Ljg5NCAxLjYxMS40OS4zNzIgMS4xMDYuNTU4IDEuODUuNTU4Ljg2MiAwIDEuNTgtLjIwMiAyLjE1NS0uNjA2em02LjYwNS0xLjc3aC0xLjIxMmMtLjU5NiAwLTEuMDQ1LjExNi0xLjM0OS4zNS0uMzAzLjIzNC0uNDU0LjUzMi0uNDU0Ljg5NCAwIC4zNzIuMTE3LjY2NC4zNS44NzcuMjM1LjIxMy41NzUuMzIgMS4wMjIuMzIuNTEgMCAuOTEyLS4xNDIgMS4yMDQtLjQyNC4yOTMtLjI4MS40NC0uNjUxLjQ0LTEuMTA4di0uOTF6bS00LjA2OC0yLjU1NFY5LjMyNWMuNjI3LS4zNjEgMS40NTctLjU0MiAyLjQ4OS0uNTQyIDIuMTE2IDAgMy4xNzUgMS4wMjYgMy4xNzUgMy4wOFYxN2gtMS41NDh2LS45NTdjLS40MTUuNjgtMS4xNDMgMS4wMi0yLjE4NiAxLjAyLS43NjYgMC0xLjM4LS4yMi0xLjg0My0uNjYxLS40NjItLjQ0Mi0uNjk0LTEuMDAzLS42OTQtMS42ODQgMC0uNzc2LjI5My0xLjM4Ljg3OC0xLjgxLjU4NS0uNDMxIDEuNDA0LS42NDcgMi40NTctLjY0N2gxLjM0VjExLjhjMC0uNTU0LS4xMzMtLjk3MS0uMzk5LTEuMjUzLS4yNjYtLjI4Mi0uNzA3LS40MjMtMS4zMjQtLjQyM2E0LjA3IDQuMDcgMCAwIDAtMi4zNDUuNzE4em05LjMzMy0xLjkzdjEuNDJjLjM5NC0xIDEuMTAxLTEuNSAyLjEyMy0xLjUuMTQ4IDAgLjMxMy4wMTYuNDk0LjA0OHYxLjUzMWExLjg4NSAxLjg4NSAwIDAgMC0uNzUtLjE0M2MtLjU0MiAwLS45ODkuMjQtMS4zNC43MTgtLjM1MS40NzktLjUyNyAxLjA0OC0uNTI3IDEuNzA3VjE3aC0xLjU2M1Y4LjkxaDEuNTYzem01LjAxIDQuMDg0Yy4wMjIuODIuMjcyIDEuNDkyLjc1IDIuMDE5LjQ3OS41MjYgMS4xNS43OSAyLjAxLjc5LjYzOSAwIDEuMjM1LS4xNzYgMS43ODgtLjUyN3YxLjQwNGMtLjUyMS4zMTktMS4xODYuNDc5LTEuOTk1LjQ3OS0xLjI2NSAwLTIuMjc2LS40LTMuMDMxLTEuMTk3LS43NTUtLjc5OC0xLjEzMy0xLjc5Mi0xLjEzMy0yLjk4NCAwLTEuMTYuMzgtMi4xNTEgMS4xNC0yLjk3NS43NjEtLjgyNSAxLjc5LTEuMjM3IDMuMDg4LTEuMjM3LjcwMiAwIDEuMzQ2LjE0OSAxLjkzLjQ0N3YxLjQzNmEzLjI0MiAzLjI0MiAwIDAgMC0xLjc3LS40OTVjLS44NCAwLTEuNTEzLjI2Ni0yLjAxOS43OTgtLjUwNS41MzItLjc1OCAxLjIxMy0uNzU4IDIuMDQyek00MC4yNCA1LjcydjQuNTc5Yy40NTgtMSAxLjI5My0xLjUgMi41MDUtMS41Ljc4NyAwIDEuNDIuMjQ1IDEuODk5LjczNC40NzkuNDkuNzE4IDEuMTcuNzE4IDIuMDQyVjE3aC0xLjU2NHYtNS4xMDZjMC0uNTUzLS4xNC0uOTgtLjQyMi0xLjI4NC0uMjgyLS4zMDMtLjY1Mi0uNDU1LTEuMTEtLjQ1NS0uNTMxIDAtMS4wMDIuMjAyLTEuNDExLjYwNi0uNDEuNDA1LS42MTUgMS4wMjItLjYxNSAxLjg1MVYxN2gtMS41NjNWNS43MmgxLjU2M3ptMTQuOTY2IDEwLjAyYy41OTYgMCAxLjA5Ni0uMjUzIDEuNS0uNzU4LjQwNC0uNTA2LjYwNi0xLjE1Ny42MDYtMS45NTUgMC0uOTE1LS4yMDItMS42Mi0uNjA2LTIuMTE0LS40MDQtLjQ5NS0uOTItLjc0Mi0xLjU0OC0uNzQyLS41NTMgMC0xLjA1LjIyNC0xLjQ5MS42Ny0uNDQyLjQ0Ny0uNjYyIDEuMTMzLS42NjIgMi4wNTggMCAuOTU4LjIxMiAxLjY3LjYzOCAyLjEzOC40MjUuNDY5Ljk0Ni43MDMgMS41NjMuNzAzek01My4wMDQgNS43MnY0LjQyYy41NzQtLjg5NCAxLjM4OC0xLjM0MSAyLjQ0LTEuMzQxIDEuMDIyIDAgMS44NTcuMzgzIDIuNTA2IDEuMTQ5LjY0OS43NjYuOTczIDEuNzgxLjk3MyAzLjA0NyAwIDEuMTM4LS4zMDkgMi4xMDktLjkyNSAyLjkxMi0uNjE3LjgwMy0xLjQ2MyAxLjIwNS0yLjUzNyAxLjIwNS0xLjA3NSAwLTEuODk0LS40NDctMi40NTctMS4zNFYxN2gtMS41OFY1LjcyaDEuNTh6bTkuOTA4IDExLjEwNGwtMy4yMjMtNy45MTNoMS43MzlsMS4wMDUgMi42MzIgMS4yNiAzLjQxNWMuMDk2LS4zMi40OC0xLjQ1OCAxLjE1LTMuNDE1bC45MDktMi42MzJoMS42NmwtMi45MiA3Ljg2NmMtLjc3NyAyLjA3NC0xLjk2MyAzLjExLTMuNTU5IDMuMTFhMi45MiAyLjkyIDAgMCAxLS43MzQtLjA3OXYtMS4zNGMuMTcuMDQyLjM1MS4wNjQuNTQzLjA2NCAxLjAzMiAwIDEuNzU1LS41NyAyLjE3LTEuNzA4eiIvPjxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik04OS42MzIgNS45Njd2LS43NzJhLjk3OC45NzggMCAwIDAtLjk3OC0uOTc3aC0yLjI4YS45NzguOTc4IDAgMCAwLS45NzguOTc3di43OTNjMCAuMDg4LjA4Mi4xNS4xNzEuMTNhNy4xMjcgNy4xMjcgMCAwIDEgMS45ODQtLjI4Yy42NSAwIDEuMjk1LjA4OCAxLjkxNy4yNTkuMDgyLjAyLjE2NC0uMDQuMTY0LS4xM20tNi4yNDggMS4wMWwtLjM5LS4zODlhLjk3Ny45NzcgMCAwIDAtMS4zODIgMGwtLjQ2NS40NjVhLjk3My45NzMgMCAwIDAgMCAxLjM4bC4zODMuMzgzYy4wNjIuMDYxLjE1LjA0Ny4yMDUtLjAxNC4yMjYtLjMwNy40NzItLjYwMS43NDYtLjg3NC4yODEtLjI4LjU2OC0uNTI2Ljg4My0uNzUxLjA2OC0uMDQyLjA3NS0uMTM3LjAyLS4ybTQuMTYgMi40NTN2My4zNDFjMCAuMDk2LjEwNC4xNjUuMTkyLjExN2wyLjk3LTEuNTM3Yy4wNjgtLjAzNC4wODktLjExNy4wNTUtLjE4NGEzLjY5NSAzLjY5NSAwIDAgMC0zLjA4LTEuODY2Yy0uMDY4IDAtLjEzNi4wNTQtLjEzNi4xM20wIDguMDQ4YTQuNDg5IDQuNDg5IDAgMCAxLTQuNDktNC40ODIgNC40ODggNC40ODggMCAwIDEgNC40OS00LjQ4MiA0LjQ4OCA0LjQ4OCAwIDAgMSA0LjQ4OSA0LjQ4MiA0LjQ4NCA0LjQ4NCAwIDAgMS00LjQ5IDQuNDgybTAtMTAuODVhNi4zNjMgNi4zNjMgMCAxIDAgMCAxMi43MjkgNi4zNyA2LjM3IDAgMCAwIDYuMzcyLTYuMzY4IDYuMzU4IDYuMzU4IDAgMCAwLTYuMzcxLTYuMzYiLz48L2c+PC9zdmc+">
            </a>
            <i class="search-icon fa fa-search"></i>
            <form id="algolia-search-form">
                <input type="text" id="algolia-search-input" name="search"
                    class="form-control input--large search-input" placeholder="Search "
                    />
            </form>
        </div>
        <div class="modal-body">
            <div class="no-result text-color-light text-center">没有找到文章</div>
            <div class="results">
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/莫比乌斯反演总结/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498829981/83039_mrjvqk.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/莫比乌斯反演总结/">
                            <h3 class="media-heading">莫比乌斯反演总结</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年6月30日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>首先大家都知道莫比乌斯反演是什么对吧，那么下面直接对一些常用的公式推导技巧进行一些汇总<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/莫比乌斯反演详解/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830269/83058_sineyx.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/莫比乌斯反演详解/">
                            <h3 class="media-heading">莫比乌斯反演详解</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年6月30日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>终于把莫比乌斯反演搞得一清二楚啦（原来我就是那么一个小地方没搞懂，<del>唉我真是太垃圾了</del>），下面对这一神奇的数论定理予以详细的介绍：</p></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/杜教筛原理详解/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830262/83053_kwvev3.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/杜教筛原理详解/">
                            <h3 class="media-heading">杜教筛原理详解</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年6月30日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>刚才简单看了下，正如某位神犇博客上所说的，大千世界，无(sang)奇(xin)不(bing)有(kuang)，居然有比线性筛还要快的算法——杜教筛 orz<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/狄利克雷卷积详解/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830177/86548_fqol95.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/06/30/狄利克雷卷积详解/">
                            <h3 class="media-heading">狄利克雷卷积详解</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年6月30日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>作为初入莫比乌斯反演的Oier，怎么能不学狄利克雷卷积呢？下面我就来简单地介绍一下：<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/01/Dilworth定理/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830244/86565_hccjkv.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/01/Dilworth定理/">
                            <h3 class="media-heading">Dilworth定理</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年7月1日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>今天这个定理是我在逛某神犇博客时看到的，是一个以前从未听说过的定理，今天我就来简单介绍一下<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6164-「美团-CodeM-初赛-Round-A」数列互质/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830261/85371_fltskc.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6164-「美团-CodeM-初赛-Round-A」数列互质/">
                            <h3 class="media-heading">#6164. 「美团 CodeM 初赛 Round A」数列互质</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年7月11日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>题解：$Libre$ $Online$ $Judge$ # $6164$. 「美团 CodeM 初赛 Round A」数列互质<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6161-「美团-CodeM-初赛-Round-A」倒水/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830238/86242_qg6y9f.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6161-「美团-CodeM-初赛-Round-A」倒水/">
                            <h3 class="media-heading">#6161. 「美团 CodeM 初赛 Round A」倒水</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年7月11日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>题解：$Libre$ $Online$ $Judge$ # $6161$. 「美团 CodeM 初赛 Round A」倒水<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6190-序列查询/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830224/86437_sz8fta.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6190-序列查询/">
                            <h3 class="media-heading">#6190. 序列查询</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年7月11日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>题解：$Libre$ $Online$ $Judge$ # $6190$. 序列查询<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6075-「2017-山东一轮集训-Day6」重建/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830203/85373_qtkof1.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6075-「2017-山东一轮集训-Day6」重建/">
                            <h3 class="media-heading">#6075. 「2017 山东一轮集训 Day6」重建</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年7月11日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>题解：$Libre$ $Online$ $Judge$ # $6075$. 「2017 山东一轮集训 Day6」重建<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
                <div class="media">
                    
                    <div class="media-left">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6136-「2017-山东三轮集训-Day4」Left/">
                            <img class="media-image" src="http://res.cloudinary.com/goseqh/image/upload/v1498830242/83064_qh7t1c.jpg" width="90" height="90"/>
                        </a>
                    </div>
                    
                    <div class="media-body">
                        <a class="link-unstyled" href="https://gqh123.github.io/2017/07/11/6136-「2017-山东三轮集训-Day4」Left/">
                            <h3 class="media-heading">#6136. 「2017 山东三轮集训 Day4」Left</h3>
                        </a>
                        <span class="media-meta">
                            <span class="media-date text-small">
                                
                                    2017年7月11日
                                
                            </span>
                        </span>
                        <div class="media-content hide-xs font-merryweather"><!-- toc -->
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>题解：$Libre$ $Online$ $Judge$ # $6136$. 「2017 山东三轮集训 Day4」Left<br></div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>
                </div>
                
            </div>
        </div>
        <div class="modal-footer">
            <p class="results-count text-medium"
                data-message-zero="没有找到文章"
                data-message-one="找到 1 篇文章"
                data-message-other="找到 {n} 篇文章">
                找到 79 篇文章
            </p>
        </div>
    </div>
</div>

        
<div id="cover" style="background-image:url('http://res.cloudinary.com/goseqh/image/upload/v1501465056/85754_kmawco.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-ivwiy10zeb8fifc4swnhkwneuk64y53w2scmdmtp8thi9cqfxh31aowtroaz.min.js"></script>
<!--SCRIPTS END-->

    


    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script>
    <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script>
        var algoliaClient = algoliasearch('VG6E0WF7PE', '5560ff8b18848ff4be8803fcf2cec428');
        var algoliaIndex = algoliaClient.initIndex('Renatus');
    </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


    </body>
</html>
